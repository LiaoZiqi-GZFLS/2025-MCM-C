\documentclass[11pt]{article}

\usepackage{fontspec, xunicode, xltxtra}
\setmainfont{Microsoft YaHei}
\usepackage{ctex}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{C}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{数据预处理}\label{ux6570ux636eux9884ux5904ux7406}

    \subsection{导入数据}\label{ux5bfcux5165ux6570ux636e}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入相关package}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{geopandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{gpd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{chardet}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{os}

\PY{c+c1}{\PYZsh{} 设置环境变量 LOKY\PYZus{}MAX\PYZus{}CPU\PYZus{}COUNT}
\PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LOKY\PYZus{}MAX\PYZus{}CPU\PYZus{}COUNT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{8}\PY{l+s+s2}{\PYZdq{}}  \PY{c+c1}{\PYZsh{} 使用CPU 核心数}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 定义一个函数，自动检测文件编码并读取文件}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 检测文件编码}
    \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
        \PY{n}{result} \PY{o}{=} \PY{n}{chardet}\PY{o}{.}\PY{n}{detect}\PY{p}{(}\PY{n}{f}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{encoding} \PY{o}{=} \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{encoding}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{检测到文件 }\PY{l+s+si}{\PYZob{}}\PY{n}{file\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ 的编码格式为：}\PY{l+s+si}{\PYZob{}}\PY{n}{encoding}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 使用检测到的编码读取文件}
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{n}{encoding}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 读取 data\PYZus{}dictionary.csv 文件}
\PY{n}{csv\PYZus{}content} \PY{o}{=} \PY{n}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{data\PYZus{}dictionary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{data\PYZus{}dictionary.csv 数据预览：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{csv\PYZus{}content}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}medal\PYZus{}counts.csv 文件}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{summerOly\PYZus{}medal\PYZus{}counts.csv 数据预览：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}hosts.csv 文件}
\PY{n}{olympic\PYZus{}hosts} \PY{o}{=} \PY{n}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}hosts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{summerOly\PYZus{}hosts.csv 数据预览：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{olympic\PYZus{}hosts}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}programs.csv 文件}
\PY{n}{olympic\PYZus{}programs} \PY{o}{=} \PY{n}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}programs.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{summerOly\PYZus{}programs.csv 数据预览：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{olympic\PYZus{}programs}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}athletes.csv 文件}
\PY{n}{olympic\PYZus{}athletes} \PY{o}{=} \PY{n}{read\PYZus{}csv\PYZus{}with\PYZus{}detected\PYZus{}encoding}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}athletes.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{summerOly\PYZus{}athletes.csv 数据预览：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{olympic\PYZus{}athletes}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
检测到文件 2025\_Problem\_C\_Data\textbackslash{}data\_dictionary.csv 的编码格式为：Windows-1252
data\_dictionary.csv 数据预览：
  summerOly\_medal\_counts.csv                                     Unnamed: 1  \textbackslash{}
0                  variables                                    explanation
1                       Rank      Rank of country based on total medals won
2                        NOC  Name of country as recorded for that Olympics
3                       Gold       Number of Gold medals the country earned
4                     Silver     Number of Silver medals the country earned

      Unnamed: 2
0        example
1           1, 2
2  China, France
3        0, 1, 2
4        0, 1, 2
检测到文件 2025\_Problem\_C\_Data\textbackslash{}summerOly\_medal\_counts.csv 的编码格式为：utf-8

summerOly\_medal\_counts.csv 数据预览：
   Rank            NOC  Gold  Silver  Bronze  Total  Year
0     1  United States    11       7       2     20  1896
1     2         Greece    10      18      19     47  1896
2     3        Germany     6       5       2     13  1896
3     4         France     5       4       2     11  1896
4     5  Great Britain     2       3       2      7  1896
检测到文件 2025\_Problem\_C\_Data\textbackslash{}summerOly\_hosts.csv 的编码格式为：UTF-8-SIG

summerOly\_hosts.csv 数据预览：
   Year                       Host
0  1896             Athens, Greece
1  1900              Paris, France
2  1904   St. Louis, United States
3  1908     London, United Kingdom
4  1912          Stockholm, Sweden
检测到文件 2025\_Problem\_C\_Data\textbackslash{}summerOly\_programs.csv 的编码格式为：Windows-1252

summerOly\_programs.csv 数据预览：
      Sport         Discipline Code Sports Governing Body 1896 1900 1904  \textbackslash{}
0  Aquatics  Artistic Swimming  SWA        World Aquatics    0    0    0
1  Aquatics             Diving  DIV        World Aquatics    0    0    2
2  Aquatics  Marathon Swimming  OWS        World Aquatics    0    0    0
3  Aquatics           Swimming  SWM        World Aquatics    4    7    9
4  Aquatics         Water Polo  WPO        World Aquatics    0    1    1

   1906*  1908 1912  {\ldots}  1988 1992  1996  2000  2004  2008  2012  2016  2020  \textbackslash{}
0      0     0    0  {\ldots}     2    2   1.0   2.0   2.0   2.0   2.0   2.0   2.0
1      1     2    4  {\ldots}     4    4   4.0   8.0   8.0   8.0   8.0   8.0   8.0
2      0     0    0  {\ldots}     0    0   0.0   0.0   0.0   2.0   2.0   2.0   2.0
3      4     6    9  {\ldots}    31   31  32.0  32.0  32.0  32.0  32.0  32.0  35.0
4      0     1    1  {\ldots}     1    1   1.0   2.0   2.0   2.0   2.0   2.0   2.0

   2024
0   2.0
1   8.0
2   2.0
3  35.0
4   2.0

[5 rows x 35 columns]
检测到文件 2025\_Problem\_C\_Data\textbackslash{}summerOly\_athletes.csv 的编码格式为：utf-8

summerOly\_athletes.csv 数据预览：
                    Name Sex            Team  NOC  Year         City  \textbackslash{}
0              A Dijiang   M           China  CHN  1992    Barcelona
1               A Lamusi   M           China  CHN  2012       London
2            Gunnar Aaby   M         Denmark  DEN  1920    Antwerpen
3            Edgar Aabye   M  Denmark/Sweden  DEN  1900        Paris
4  Cornelia (-strannood)   F     Netherlands  NED  1932  Los Angeles

        Sport                         Event     Medal
0  Basketball   Basketball Men's Basketball  No medal
1        Judo  Judo Men's Extra-Lightweight  No medal
2    Football       Football Men's Football  No medal
3  Tug-Of-War   Tug-Of-War Men's Tug-Of-War      Gold
4   Athletics  Athletics Women's 100 metres  No medal
    \end{Verbatim}

    \subsection{数据清洗}\label{ux6570ux636eux6e05ux6d17}

    \subsubsection{缺失值检查}\label{ux7f3aux5931ux503cux68c0ux67e5}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 1. 缺失值检查}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{check\PYZus{}missing\PYZus{}values}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    检查 CSV 文件中的缺失值。}

\PY{l+s+sd}{    参数:}
\PY{l+s+sd}{        file\PYZus{}path (str): CSV 文件的路径。}

\PY{l+s+sd}{    返回:}
\PY{l+s+sd}{        None，但会打印缺失值的相关信息。}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{try}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} 尝试读取 CSV 文件}
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{except} \PY{n+ne}{UnicodeDecodeError}\PY{p}{:}
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ISO\PYZhy{}8859\PYZhy{}1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n+nb}{print}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 检查每列的缺失值数量}
    \PY{n}{missing\PYZus{}values\PYZus{}per\PYZus{}column} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{每列的缺失值数量：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{missing\PYZus{}values\PYZus{}per\PYZus{}column}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 检查整个数据框的总缺失值数量}
    \PY{n}{total\PYZus{}missing\PYZus{}values} \PY{o}{=} \PY{n}{missing\PYZus{}values\PYZus{}per\PYZus{}column}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{整个数据框的总缺失值数量：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{total\PYZus{}missing\PYZus{}values}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 检查是否有任何缺失值}
    \PY{n}{has\PYZus{}missing\PYZus{}values} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{数据框中是否存在缺失值：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{has\PYZus{}missing\PYZus{}values}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} 如果有缺失值，输出包含缺失值的行}
    \PY{k}{if} \PY{n}{has\PYZus{}missing\PYZus{}values}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{包含缺失值的行：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{p}{)}
    
\PY{n}{content\PYZus{}name} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}hosts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}programs.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}athletes.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{content\PYZus{}name}\PY{p}{:}
    \PY{n}{check\PYZus{}missing\PYZus{}values}\PY{p}{(}\PY{n}{i}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
2025\_Problem\_C\_Data\textbackslash{}summerOly\_medal\_counts.csv
每列的缺失值数量：
Rank      0
NOC       0
Gold      0
Silver    0
Bronze    0
Total     0
Year      0
dtype: int64
整个数据框的总缺失值数量： 0
数据框中是否存在缺失值： False


2025\_Problem\_C\_Data\textbackslash{}summerOly\_hosts.csv
每列的缺失值数量：
Year    0
Host    0
dtype: int64
整个数据框的总缺失值数量： 0
数据框中是否存在缺失值： False


2025\_Problem\_C\_Data\textbackslash{}summerOly\_programs.csv
每列的缺失值数量：
Sport                    0
Discipline               2
Code                     0
Sports Governing Body    0
1896                     0
1900                     0
1904                     0
1906*                    0
1908                     0
1912                     0
1920                     0
1924                     0
1928                     2
1932                     2
1936                     2
1948                     2
1952                     2
1956                     2
1960                     2
1964                     2
1968                     2
1972                     2
1976                     2
1980                     2
1984                     2
1988                     3
1992                     2
1996                     2
2000                     2
2004                     2
2008                     2
2012                     2
2016                     2
2020                     2
2024                     2
dtype: int64
整个数据框的总缺失值数量： 49
数据框中是否存在缺失值： True



包含缺失值的行：
                Sport     Discipline Code Sports Governing Body 1896 1900  \textbackslash{}
12      Basque Pelota  Basque Pelota  PEL                  FIPV    0    1
44  Modern Pentathlon            NaN  MPN                  UIPM    0    0
65  Water Motorsports            NaN  PBT                   UIM    0    
69            Skating         Figure  FSK                   ISU    0    0
70         Ice Hockey     Ice Hockey  IHO                  IIHF    0    0

   1904  1906*  1908 1912  {\ldots}  1988 1992 1996 2000 2004 2008  2012 2016  \textbackslash{}
12    0      0     0    0  {\ldots}   NaN      0.0  0.0  0.0  0.0   0.0  0.0
44    0      0     0    1  {\ldots}     2    2  1.0  2.0  2.0  2.0   2.0  2.0
65    0      0     3    0  {\ldots}     0    0  0.0  0.0  0.0  0.0   0.0  0.0
69    0      0     4    0  {\ldots}   NaN  NaN  NaN  NaN  NaN  NaN   NaN  NaN
70    0      0     0    0  {\ldots}   NaN  NaN  NaN  NaN  NaN  NaN   NaN  NaN

    2020 2024
12   0.0  0.0
44   2.0  2.0
65   0.0  0.0
69   NaN  NaN
70   NaN  NaN

[5 rows x 35 columns]
2025\_Problem\_C\_Data\textbackslash{}summerOly\_athletes.csv
每列的缺失值数量：
Name     0
Sex      0
Team     0
NOC      0
Year     0
City     0
Sport    0
Event    0
Medal    0
dtype: int64
整个数据框的总缺失值数量： 0
数据框中是否存在缺失值： False


    \end{Verbatim}

    \subsubsection{补全summerOly\_programs.csv中的缺失值}\label{ux8865ux5168summeroly_programs.csvux4e2dux7684ux7f3aux5931ux503c}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{RandomForestRegressor}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{KNeighborsRegressor}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{re}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{os}

\PY{c+c1}{\PYZsh{} 确保保存结果的目录存在}
\PY{n}{os}\PY{o}{.}\PY{n}{makedirs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{exist\PYZus{}ok}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{olympic\PYZus{}programs}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 3. 检查缺失值}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}每列的缺失值数量：\PYZdq{})}
\PY{c+c1}{\PYZsh{}print(data.isnull().sum())}

\PY{c+c1}{\PYZsh{} 4. 填充 Discipline 列的缺失值}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Discipline}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Discipline}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 5. 准备年份列的数据}
\PY{n}{years} \PY{o}{=} \PY{p}{[}\PY{n}{col} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{n}{col}\PY{o}{.}\PY{n}{isdigit}\PY{p}{(}\PY{p}{)} \PY{o+ow}{or} \PY{n}{col}\PY{o}{.}\PY{n}{endswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 6. 将数据从宽格式转换为长格式}
\PY{n}{data\PYZus{}long} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{melt}\PY{p}{(}\PY{n}{id\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Discipline}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sports Governing Body}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} 
                      \PY{n}{value\PYZus{}vars}\PY{o}{=}\PY{n}{years}\PY{p}{,} 
                      \PY{n}{var\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{n}{value\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 7. 将年份列转换为数值}
\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 8. 清理 Events 列中的非数值字符}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{clean\PYZus{}events}\PY{p}{(}\PY{n}{value}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{value}\PY{p}{,} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} 移除非数值字符}
        \PY{n}{cleaned\PYZus{}value} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}0\PYZhy{}9]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{value}\PY{p}{)}
        \PY{k}{return} \PY{n+nb}{float}\PY{p}{(}\PY{n}{cleaned\PYZus{}value}\PY{p}{)} \PY{k}{if} \PY{n}{cleaned\PYZus{}value}\PY{o}{.}\PY{n}{isdigit}\PY{p}{(}\PY{p}{)} \PY{k}{else} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
    \PY{k}{return} \PY{n}{value}

\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{clean\PYZus{}events}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 9. 将1924年以及之后的 Skating 和 Ice Hockey 项目的赛事数目填为0}
\PY{n}{mask} \PY{o}{=} \PY{p}{(}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{1924}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Skating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ice Hockey}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{mask}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} 10. 分组处理，按运动种类单独训练模型}
\PY{k}{for} \PY{n}{sport}\PY{p}{,} \PY{n}{group} \PY{o+ow}{in} \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 分离已知数据和缺失数据}
    \PY{n}{known\PYZus{}data} \PY{o}{=} \PY{n}{group}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{n}{missing\PYZus{}data} \PY{o}{=} \PY{n}{group}\PY{p}{[}\PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}
    
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{known\PYZus{}data}\PY{o}{.}\PY{n}{empty} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{missing\PYZus{}data}\PY{o}{.}\PY{n}{empty}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} 准备训练数据}
        \PY{n}{X\PYZus{}known} \PY{o}{=} \PY{n}{known\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{y\PYZus{}known} \PY{o}{=} \PY{n}{known\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} 检查已知数据的数量}
        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}known}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{5}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{警告：运动种类 }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sport}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ 的已知数据太少，使用 KNN 或线性回归填充。}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 尝试使用线性回归}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}known}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{3}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 至少需要3个点来拟合线性回归}
                \PY{n}{model} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
                \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}known}\PY{p}{,} \PY{n}{y\PYZus{}known}\PY{p}{)}
                \PY{n}{predicted\PYZus{}events} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{missing\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 使用 KNN，K=1}
                \PY{n}{model} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}known}\PY{p}{,} \PY{n}{y\PYZus{}known}\PY{p}{)}
                \PY{n}{predicted\PYZus{}events} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{missing\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 将预测值四舍五入为整数}
            \PY{n}{predicted\PYZus{}events} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{predicted\PYZus{}events}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 将预测值转换为 Pandas Series，并确保索引对齐}
            \PY{n}{predicted\PYZus{}series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{predicted\PYZus{}events}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{missing\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 填充缺失值}
            \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{sport}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{sport}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{predicted\PYZus{}series}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} 训练随机森林模型}
            \PY{n}{model} \PY{o}{=} \PY{n}{RandomForestRegressor}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
            \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}known}\PY{p}{,} \PY{n}{y\PYZus{}known}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 预测缺失数据}
            \PY{n}{X\PYZus{}missing} \PY{o}{=} \PY{n}{missing\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
            \PY{n}{predicted\PYZus{}events} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}missing}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 将预测值四舍五入为整数}
            \PY{n}{predicted\PYZus{}events} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{predicted\PYZus{}events}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 将预测值转换为 Pandas Series，并确保索引对齐}
            \PY{n}{predicted\PYZus{}series} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{predicted\PYZus{}events}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{missing\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 填充缺失值}
            \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{sport}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data\PYZus{}long}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{sport}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{predicted\PYZus{}series}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} 记录日志}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{运动种类 }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sport}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ 的模型训练完成，预测了 }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{predicted\PYZus{}events}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ 个缺失值。}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{运动种类 }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{sport}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ 没有缺失数据或没有足够的已知数据。}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 11. 将数据重新转换为宽格式}
\PY{n}{data\PYZus{}filled} \PY{o}{=} \PY{n}{data\PYZus{}long}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Discipline}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sports Governing Body}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} 
                                    \PY{n}{columns}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                    \PY{n}{values}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                    \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 12. 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{填充后的数据：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{data\PYZus{}filled}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 13. 保存结果到新的 CSV 文件}
\PY{n}{output\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}programs\PYZus{}filled.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data\PYZus{}filled}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 确保保存时使用正确的编码}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{填充后的数据已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
运动种类 'Aquatics' 没有缺失数据或没有足够的已知数据。
运动种类 'Archery' 没有缺失数据或没有足够的已知数据。
运动种类 'Athletics' 没有缺失数据或没有足够的已知数据。
运动种类 'Badminton' 的模型训练完成，预测了 2 个缺失值。
运动种类 'Baseball and Softball' 的模型训练完成，预测了 8 个缺失值。
运动种类 'Basketball' 的模型训练完成，预测了 2 个缺失值。
运动种类 'Basque Pelota' 的模型训练完成，预测了 4 个缺失值。
运动种类 'Boxing' 没有缺失数据或没有足够的已知数据。
运动种类 'Breaking' 没有缺失数据或没有足够的已知数据。
运动种类 'Canoeing' 的模型训练完成，预测了 1 个缺失值。
运动种类 'Cricket' 没有缺失数据或没有足够的已知数据。
运动种类 'Croquet' 没有缺失数据或没有足够的已知数据。
运动种类 'Cycling' 没有缺失数据或没有足够的已知数据。
运动种类 'Equestrian' 没有缺失数据或没有足够的已知数据。
运动种类 'Fencing' 没有缺失数据或没有足够的已知数据。
运动种类 'Field hockey' 没有缺失数据或没有足够的已知数据。
运动种类 'Flag football' 没有缺失数据或没有足够的已知数据。
运动种类 'Football' 没有缺失数据或没有足够的已知数据。
运动种类 'Golf' 没有缺失数据或没有足够的已知数据。
运动种类 'Gymnastics' 没有缺失数据或没有足够的已知数据。
运动种类 'Handball' 的模型训练完成，预测了 1 个缺失值。
运动种类 'Ice Hockey' 没有缺失数据或没有足够的已知数据。
运动种类 'Jeu de Paume' 没有缺失数据或没有足够的已知数据。
运动种类 'Judo' 没有缺失数据或没有足够的已知数据。
运动种类 'Karate' 没有缺失数据或没有足够的已知数据。
运动种类 'Lacrosse' 的模型训练完成，预测了 3 个缺失值。
运动种类 'Modern Pentathlon' 没有缺失数据或没有足够的已知数据。
运动种类 'Polo' 没有缺失数据或没有足够的已知数据。
运动种类 'Rackets' 没有缺失数据或没有足够的已知数据。
运动种类 'Roque' 没有缺失数据或没有足够的已知数据。
运动种类 'Rowing' 没有缺失数据或没有足够的已知数据。
运动种类 'Rugby' 没有缺失数据或没有足够的已知数据。
运动种类 'Sailing' 没有缺失数据或没有足够的已知数据。
运动种类 'Shooting' 没有缺失数据或没有足够的已知数据。
运动种类 'Skateboarding' 没有缺失数据或没有足够的已知数据。
运动种类 'Skating' 没有缺失数据或没有足够的已知数据。
运动种类 'Sport Climbing' 没有缺失数据或没有足够的已知数据。
运动种类 'Squash' 没有缺失数据或没有足够的已知数据。
运动种类 'Surfing' 没有缺失数据或没有足够的已知数据。
运动种类 'Table Tennis' 没有缺失数据或没有足够的已知数据。
运动种类 'Taekwondo' 的模型训练完成，预测了 2 个缺失值。
运动种类 'Tennis' 的模型训练完成，预测了 2 个缺失值。
运动种类 'Total disciplines' 没有缺失数据或没有足够的已知数据。
运动种类 'Total events' 没有缺失数据或没有足够的已知数据。
运动种类 'Total sports' 没有缺失数据或没有足够的已知数据。
运动种类 'Triathlon' 没有缺失数据或没有足够的已知数据。
运动种类 'Tug of War' 没有缺失数据或没有足够的已知数据。
运动种类 'Volleyball' 的模型训练完成，预测了 1 个缺失值。
运动种类 'Water Motorsports' 的模型训练完成，预测了 1 个缺失值。
运动种类 'Weightlifting' 没有缺失数据或没有足够的已知数据。
运动种类 'Wrestling' 没有缺失数据或没有足够的已知数据。

填充后的数据：
Year     Sport         Discipline Code Sports Governing Body  1896  1900  \textbackslash{}
0     Aquatics  Artistic Swimming  SWA        World Aquatics   0.0   0.0
1     Aquatics             Diving  DIV        World Aquatics   0.0   0.0
2     Aquatics  Marathon Swimming  OWS        World Aquatics   0.0   0.0
3     Aquatics           Swimming  SWM        World Aquatics   4.0   7.0
4     Aquatics         Water Polo  WPO        World Aquatics   0.0   1.0

Year  1904  1906  1908  1912  {\ldots}  1988  1992  1996  2000  2004  2008  2012  \textbackslash{}
0      0.0   0.0   0.0   0.0  {\ldots}   2.0   2.0   1.0   2.0   2.0   2.0   2.0
1      2.0   1.0   2.0   4.0  {\ldots}   4.0   4.0   4.0   8.0   8.0   8.0   8.0
2      0.0   0.0   0.0   0.0  {\ldots}   0.0   0.0   0.0   0.0   0.0   2.0   2.0
3      9.0   4.0   6.0   9.0  {\ldots}  31.0  31.0  32.0  32.0  32.0  32.0  32.0
4      1.0   0.0   1.0   1.0  {\ldots}   1.0   1.0   1.0   2.0   2.0   2.0   2.0

Year  2016  2020  2024
0      2.0   2.0   2.0
1      8.0   8.0   8.0
2      2.0   2.0   2.0
3     32.0  35.0  35.0
4      2.0   2.0   2.0

[5 rows x 35 columns]
填充后的数据已保存到 Generated\textbackslash{}summerOly\_programs\_filled.csv
    \end{Verbatim}

    \subsubsection{Medal\_counts
数据清洗}\label{medal_counts-ux6570ux636eux6e05ux6d17}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 2. 数据清洗}
\PY{c+c1}{\PYZsh{} 确保数据的格式正确}
\PY{n}{data} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 3. 创建年份和国家的索引}
\PY{n}{years} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\PY{n}{noc} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 4. 定义一个函数来生成表格}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{generate\PYZus{}table}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 创建一个空的 DataFrame，以年份为列，国家为行}
    \PY{n}{table} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{noc}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{years}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} 填充数据}
    \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{n}{year} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{value} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}
        \PY{n}{table}\PY{o}{.}\PY{n}{at}\PY{p}{[}\PY{n}{country}\PY{p}{,} \PY{n}{year}\PY{p}{]} \PY{o}{=} \PY{n}{value}
    
    \PY{c+c1}{\PYZsh{} 推断数据类型并填充缺失值为0}
    \PY{n}{table} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{infer\PYZus{}objects}\PY{p}{(}\PY{n}{copy}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{table}

\PY{c+c1}{\PYZsh{} 5. 生成金牌、银牌、铜牌和总数的表格}
\PY{n}{gold\PYZus{}table} \PY{o}{=} \PY{n}{generate\PYZus{}table}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{silver\PYZus{}table} \PY{o}{=} \PY{n}{generate\PYZus{}table}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{bronze\PYZus{}table} \PY{o}{=} \PY{n}{generate\PYZus{}table}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{total\PYZus{}table} \PY{o}{=} \PY{n}{generate\PYZus{}table}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 6. 保存到新的 CSV 文件}
\PY{n}{gold\PYZus{}table}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}gold\PYZus{}summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{silver\PYZus{}table}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}silver\PYZus{}summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{bronze\PYZus{}table}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}bronze\PYZus{}summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{total\PYZus{}table}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}total\PYZus{}summary.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 7. 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{金牌表格：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{gold\PYZus{}table}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
金牌表格：
                      1896  1900  1904  1908  1912  1920  1924  1928  1932  \textbackslash{}
United States           11    19    76    23    26    41    45    22     0
Greece                  10     0     1     0     1     0     0     0     0
Germany                  6     4     4     3     5     0     0    10     0
France                   5    27     0     5     7     9    13     6     0
Great Britain            2    15     1    56    10    14     9     3     0
{\ldots}                    {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     0     0     0     0     0     0     0
Dominica                 0     0     0     0     0     0     0     0     0
Albania                  0     0     0     0     0     0     0     0     0
Cabo Verde               0     0     0     0     0     0     0     0     0
Refugee Olympic Team     0     0     0     0     0     0     0     0     0

                      1936  {\ldots}  1988  1992  1996  2000  2004  2008  2012  \textbackslash{}
United States           24  {\ldots}    36    37    44    37    36    36    48
Greece                   0  {\ldots}     0     2     4     4     6     0     0
Germany                 38  {\ldots}     0    33    20    13    13    16    11
France                   7  {\ldots}     6     8    15    13    11     7    11
Great Britain            4  {\ldots}     5     5     1    11     9    19    29
{\ldots}                    {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0  {\ldots}     0     0     0     0     0     0     0
Dominica                 0  {\ldots}     0     0     0     0     0     0     0
Albania                  0  {\ldots}     0     0     0     0     0     0     0
Cabo Verde               0  {\ldots}     0     0     0     0     0     0     0
Refugee Olympic Team     0  {\ldots}     0     0     0     0     0     0     0

                      2016  2020  2024
United States           46    39    40
Greece                   3     2     1
Germany                 17    10    12
France                  10    10    16
Great Britain           27    22    14
{\ldots}                    {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     1
Dominica                 0     0     1
Albania                  0     0     0
Cabo Verde               0     0     0
Refugee Olympic Team     0     0     0

[210 rows x 30 columns]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{银牌表格：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{silver\PYZus{}table}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]

银牌表格：
                      1896  1900  1904  1908  1912  1920  1924  1928  1932  \textbackslash{}
United States            7    14    78    12    19    27    27    18     0
Greece                  18     0     0     3     0     1     0     0     0
Germany                  5     3     5     5    13     0     0     7     0
France                   4    39     1     5     4    19    15    10     0
Great Britain            3     7     1    51    15    15    13    10     0
{\ldots}                    {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     0     0     0     0     0     0     0
Dominica                 0     0     0     0     0     0     0     0     0
Albania                  0     0     0     0     0     0     0     0     0
Cabo Verde               0     0     0     0     0     0     0     0     0
Refugee Olympic Team     0     0     0     0     0     0     0     0     0

                      1936  {\ldots}  1988  1992  1996  2000  2004  2008  2012  \textbackslash{}
United States           21  {\ldots}    31    34    32    24    39    39    26
Greece                   0  {\ldots}     0     0     4     6     6     2     0
Germany                 31  {\ldots}     0    21    18    17    16    11    20
France                   6  {\ldots}     4     5     7    14     9    16    11
Great Britain            7  {\ldots}    10     3     8    10     9    13    18
{\ldots}                    {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0  {\ldots}     0     0     0     0     0     0     0
Dominica                 0  {\ldots}     0     0     0     0     0     0     0
Albania                  0  {\ldots}     0     0     0     0     0     0     0
Cabo Verde               0  {\ldots}     0     0     0     0     0     0     0
Refugee Olympic Team     0  {\ldots}     0     0     0     0     0     0     0

                      2016  2020  2024
United States           37    41    44
Greece                   1     1     1
Germany                 10    11    13
France                  18    12    26
Great Britain           23    20    22
{\ldots}                    {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     1
Dominica                 0     0     0
Albania                  0     0     0
Cabo Verde               0     0     0
Refugee Olympic Team     0     0     0

[210 rows x 30 columns]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{铜牌表格：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{bronze\PYZus{}table}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]

铜牌表格：
                      1896  1900  1904  1908  1912  1920  1924  1928  1932  \textbackslash{}
United States            2    15    77    12    19    27    27    16     0
Greece                  19     0     1     1     1     0     0     0     0
Germany                  2     2     6     5     7     0     0    14     0
France                   2    37     0     9     3    13    10     5     0
Great Britain            2     9     0    39    16    13    12     7     0
{\ldots}                    {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     0     0     0     0     0     0     0
Dominica                 0     0     0     0     0     0     0     0     0
Albania                  0     0     0     0     0     0     0     0     0
Cabo Verde               0     0     0     0     0     0     0     0     0
Refugee Olympic Team     0     0     0     0     0     0     0     0     0

                      1936  {\ldots}  1988  1992  1996  2000  2004  2008  2012  \textbackslash{}
United States           12  {\ldots}    27    37    25    32    26    37    30
Greece                   0  {\ldots}     1     0     0     3     4     1     2
Germany                 32  {\ldots}     0    28    27    26    20    14    13
France                   6  {\ldots}     6    16    15    11    13    20    13
Great Britain            3  {\ldots}     9    12     6     7    12    19    18
{\ldots}                    {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0  {\ldots}     0     0     0     0     0     0     0
Dominica                 0  {\ldots}     0     0     0     0     0     0     0
Albania                  0  {\ldots}     0     0     0     0     0     0     0
Cabo Verde               0  {\ldots}     0     0     0     0     0     0     0
Refugee Olympic Team     0  {\ldots}     0     0     0     0     0     0     0

                      2016  2020  2024
United States           38    33    42
Greece                   2     1     6
Germany                 15    16     8
France                  14    11    22
Great Britain           17    22    29
{\ldots}                    {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     0
Dominica                 0     0     0
Albania                  0     0     2
Cabo Verde               0     0     1
Refugee Olympic Team     0     0     1

[210 rows x 30 columns]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{总数表格：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{total\PYZus{}table}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]

总数表格：
                      1896  1900  1904  1908  1912  1920  1924  1928  1932  \textbackslash{}
United States           20    48   231    47    64    95    99    56     0
Greece                  47     0     2     4     2     1     0     0     0
Germany                 13     9    15    13    25     0     0    31     0
France                  11   103     1    19    14    41    38    21     0
Great Britain            7    31     2   146    41    42    34    20     0
{\ldots}                    {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     0     0     0     0     0     0     0
Dominica                 0     0     0     0     0     0     0     0     0
Albania                  0     0     0     0     0     0     0     0     0
Cabo Verde               0     0     0     0     0     0     0     0     0
Refugee Olympic Team     0     0     0     0     0     0     0     0     0

                      1936  {\ldots}  1988  1992  1996  2000  2004  2008  2012  \textbackslash{}
United States           57  {\ldots}    94   108   101    93   101   112   104
Greece                   0  {\ldots}     1     2     8    13    16     3     2
Germany                101  {\ldots}     0    82    65    56    49    41    44
France                  19  {\ldots}    16    29    37    38    33    43    35
Great Britain           14  {\ldots}    24    20    15    28    30    51    65
{\ldots}                    {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0  {\ldots}     0     0     0     0     0     0     0
Dominica                 0  {\ldots}     0     0     0     0     0     0     0
Albania                  0  {\ldots}     0     0     0     0     0     0     0
Cabo Verde               0  {\ldots}     0     0     0     0     0     0     0
Refugee Olympic Team     0  {\ldots}     0     0     0     0     0     0     0

                      2016  2020  2024
United States          121   113   126
Greece                   6     4     8
Germany                 42    37    33
France                  42    33    64
Great Britain           67    64    65
{\ldots}                    {\ldots}   {\ldots}   {\ldots}
Saint Lucia              0     0     2
Dominica                 0     0     1
Albania                  0     0     2
Cabo Verde               0     0     1
Refugee Olympic Team     0     0     1

[210 rows x 30 columns]
    \end{Verbatim}

    \subsubsection{清理summerOly\_medal\_counts.csv异常值}\label{ux6e05ux7406summeroly_medal_counts.csvux5f02ux5e38ux503c}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{impute}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{KNNImputer}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义一个函数，用于剔除非英文字符}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{remove\PYZus{}non\PYZus{}english\PYZus{}chars}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{pd}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{text}
    \PY{k}{return} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}a\PYZhy{}zA\PYZhy{}Z]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{text}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 对NOC列进行数据检查和处理}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{remove\PYZus{}non\PYZus{}english\PYZus{}chars}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 提取实际的奥运会年份}
\PY{n}{olympic\PYZus{}years} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\PY{n}{olympic\PYZus{}years} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{olympic\PYZus{}years}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 按年份排序}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{实际的奥运会年份：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{olympic\PYZus{}years}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将数据按年份和国家分组}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 获取所有国家}
\PY{n}{countries} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建一个完整的年份和国家组合的DataFrame}
\PY{n}{all\PYZus{}combinations} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{MultiIndex}\PY{o}{.}\PY{n}{from\PYZus{}product}\PY{p}{(}\PY{p}{[}\PY{n}{olympic\PYZus{}years}\PY{p}{,} \PY{n}{countries}\PY{p}{]}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}frame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 合并数据，填充缺失值为NaN（暂时不填充为0）}
\PY{n}{complete\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{all\PYZus{}combinations}\PY{p}{,} \PY{n}{data}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算每个国家首次参加奥运会的时间}
\PY{n}{first\PYZus{}participation} \PY{o}{=} \PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{first\PYZus{}participation}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Participation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{complete\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{,} \PY{n}{first\PYZus{}participation}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将每个国家在首次参加之前的所有年份的奖牌数填充为0}
\PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Participation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} 将首次参加时间列删除，因为它已经不再需要}
\PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First\PYZus{}Participation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义一个函数来处理每个奖牌类型}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{knn\PYZus{}impute}\PY{p}{(}\PY{n}{column\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 提取需要处理的列}
    \PY{n}{grouped} \PY{o}{=} \PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 将分组结果转换为多个 DataFrame}
    \PY{n}{grouped\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{group} \PY{k}{for} \PY{n}{noc}\PY{p}{,} \PY{n}{group} \PY{o+ow}{in} \PY{n}{grouped}\PY{p}{]}
    \PY{k}{for} \PY{n}{df} \PY{o+ow}{in} \PY{n}{grouped\PYZus{}dfs}\PY{p}{:}
        \PY{n}{current\PYZus{}noc} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 由于每个分组的 \PYZsq{}NOC\PYZsq{} 是相同的，可以直接取第一个值}
        \PY{c+c1}{\PYZsh{}print(f\PYZdq{}当前组的 NOC: \PYZob{}current\PYZus{}noc\PYZcb{}\PYZdq{})}

        \PY{c+c1}{\PYZsh{} 初始化 KNNImputer}
        \PY{n}{imputer} \PY{o}{=} \PY{n}{KNNImputer}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} n\PYZus{}neighbors 是邻居数量，weights 可以选择 \PYZsq{}uniform\PYZsq{} 或 \PYZsq{}distance\PYZsq{}}

        \PY{c+c1}{\PYZsh{} 选择需要填充的列}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{df\PYZus{}filled} \PY{o}{=} \PY{n}{imputer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]}\PY{p}{]}\PY{p}{)}
        \PY{k}{except} \PY{n+ne}{ValueError} \PY{k}{as} \PY{n}{e}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Error processing }\PY{l+s+si}{\PYZob{}}\PY{n}{current\PYZus{}noc}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ for }\PY{l+s+si}{\PYZob{}}\PY{n}{column\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{e}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k}{continue}

        \PY{c+c1}{\PYZsh{} 将结果转换回 DataFrame}
        \PY{n}{df\PYZus{}filled} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df\PYZus{}filled}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print(df\PYZus{}filled)}

        \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
        \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

        \PY{c+c1}{\PYZsh{}print(df\PYZus{}filled)}
        
        \PY{c+c1}{\PYZsh{} 合并回原始数据}
        \PY{c+c1}{\PYZsh{}complete\PYZus{}data[\PYZsq{}NOC\PYZsq{}==current\PYZus{}noc, column\PYZus{}name] = df\PYZus{}filled[column\PYZus{}name]}
        \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
            \PY{n}{index} \PY{o}{=} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{year}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{n}{original\PYZus{}value} \PY{o}{=} \PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}noc}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{year}\PY{p}{)}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]}
            
            \PY{k}{if} \PY{n}{original\PYZus{}value}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 如果存在 NaN 值，进行填充}
                \PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}noc}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{year}\PY{p}{)}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{index}\PY{p}{]}
            \PY{k}{else}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 获取原始值和填充值}
                \PY{n}{original\PYZus{}value} \PY{o}{=} \PY{n}{original\PYZus{}value}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 获取具体的数值}
                \PY{n}{imputed\PYZus{}value} \PY{o}{=} \PY{n}{df\PYZus{}filled}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{index}\PY{p}{]}
                
                \PY{c+c1}{\PYZsh{} 检查分母是否为零}
                \PY{k}{if} \PY{n}{imputed\PYZus{}value} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{k}{if} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{original\PYZus{}value} \PY{o}{\PYZhy{}} \PY{n}{imputed\PYZus{}value}\PY{p}{)} \PY{o}{/} \PY{n}{imputed\PYZus{}value} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.2}\PY{p}{:}
                        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Large difference detected for }\PY{l+s+si}{\PYZob{}}\PY{n}{current\PYZus{}noc}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ in }\PY{l+s+si}{\PYZob{}}\PY{n}{year}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{: original=}\PY{l+s+si}{\PYZob{}}\PY{n}{original\PYZus{}value}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, imputed=}\PY{l+s+si}{\PYZob{}}\PY{n}{imputed\PYZus{}value}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                        \PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}noc}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{year}\PY{p}{)}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{imputed\PYZus{}value}
                \PY{c+c1}{\PYZsh{}else:}
                    \PY{c+c1}{\PYZsh{}print(f\PYZdq{}Imputed value is zero for \PYZob{}current\PYZus{}noc\PYZcb{} in \PYZob{}year\PYZcb{}, skipping division.\PYZdq{})}

\PY{k}{def}\PY{+w}{ }\PY{n+nf}{adjust\PYZus{}outliers}\PY{p}{(}\PY{n}{column\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Adjusting outliers for }\PY{l+s+si}{\PYZob{}}\PY{n}{column\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{current\PYZus{}noc} \PY{o+ow}{in} \PY{n}{countries}\PY{p}{:}
        \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}noc}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
            \PY{n}{current\PYZus{}year} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{n}{current\PYZus{}value} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}
            \PY{n}{prev\PYZus{}value} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}
            \PY{n}{next\PYZus{}value} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{column\PYZus{}name}\PY{p}{]}
            
            \PY{k}{if} \PY{n}{prev\PYZus{}value} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{or} \PY{n}{next\PYZus{}value} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                \PY{k}{continue}

            \PY{c+c1}{\PYZsh{} 计算左右年份的平均值}
            \PY{n}{avg\PYZus{}value} \PY{o}{=} \PY{p}{(}\PY{n}{prev\PYZus{}value} \PY{o}{+} \PY{n}{next\PYZus{}value}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
            
            \PY{c+c1}{\PYZsh{} 检查当前值是否偏离平均值超过50\PYZpc{}}
            \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{current\PYZus{}value} \PY{o}{\PYZhy{}} \PY{n}{avg\PYZus{}value}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{avg\PYZus{}value}\PY{p}{)} \PY{o+ow}{and} \PY{n}{current\PYZus{}value} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{avg\PYZus{}value}\PY{p}{)} \PY{o+ow}{or} \PY{p}{(}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{current\PYZus{}value} \PY{o}{\PYZhy{}} \PY{n}{avg\PYZus{}value}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{current\PYZus{}value}\PY{p}{)} \PY{o+ow}{and} \PY{n}{current\PYZus{}value} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{avg\PYZus{}value}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 替换为三个值的平均值}
                \PY{n}{new\PYZus{}value} \PY{o}{=} \PY{p}{(}\PY{n}{current\PYZus{}value} \PY{o}{+} \PY{n}{prev\PYZus{}value} \PY{o}{+} \PY{n}{next\PYZus{}value}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{3}
                \PY{n}{new\PYZus{}value} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{new\PYZus{}value}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}print(f\PYZdq{}Outlier detected for \PYZob{}current\PYZus{}noc\PYZcb{} in \PYZob{}current\PYZus{}year\PYZcb{}: original=\PYZob{}current\PYZus{}value\PYZcb{}, adjusted=\PYZob{}new\PYZus{}value\PYZcb{}\PYZdq{})}
                \PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}noc}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{complete\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{current\PYZus{}year}\PY{p}{)}\PY{p}{,} \PY{n}{column\PYZus{}name}\PY{p}{]} \PY{o}{=} \PY{n}{new\PYZus{}value}

\PY{n}{medal\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 进行KNN补全}
\PY{k}{for} \PY{n}{medal} \PY{o+ow}{in} \PY{n}{medal\PYZus{}list}\PY{p}{:}
    \PY{n}{knn\PYZus{}impute}\PY{p}{(}\PY{n}{medal}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 调整异常值}
\PY{k}{for} \PY{n}{medal} \PY{o+ow}{in} \PY{n}{medal\PYZus{}list}\PY{p}{:}
    \PY{n}{adjust\PYZus{}outliers}\PY{p}{(}\PY{n}{medal}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存处理后的数据为CSV文件}
\PY{n}{output\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}imputed.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{complete\PYZus{}data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}file}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{处理后的数据已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}file}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
实际的奥运会年份： [1896 1900 1904 1908 1912 1920 1924 1928 1932 1936 1948 1952 1956 1960
 1964 1968 1972 1976 1980 1984 1988 1992 1996 2000 2004 2008 2012 2016
 2020 2024]
Adjusting outliers for Total
Adjusting outliers for Gold
Adjusting outliers for Silver
Adjusting outliers for Bronze
处理后的数据已保存到 Generated\textbackslash{}summerOly\_medal\_counts\_imputed.csv
    \end{Verbatim}

    \subsubsection{处理国家变更与如今不存在的国家}\label{ux5904ux7406ux56fdux5bb6ux53d8ux66f4ux4e0eux5982ux4ecaux4e0dux5b58ux5728ux7684ux56fdux5bb6}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}imputed.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义国家名称映射关系}
\PY{n}{country\PYZus{}mapping} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WestGermany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Germany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EastGermany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Germany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{UnitedTeamofGermany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Germany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RussianEmpire}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Russia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SovietUnion}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Russia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Czechoslovakia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CzechRepublic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Yugoslavia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Serbia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bohemia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CzechRepublic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Formosa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Taiwan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mixedteam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mixedteam}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 更新国家名称}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{country\PYZus{}mapping}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 去除如今不存在的国家}
\PY{n}{current\PYZus{}countries} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{UnitedStates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Greece}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Germany}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{France}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GreatBritain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hungary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Austria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Australia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Denmark}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Switzerland}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mixedteam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Belgium}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Italy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cuba}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Canada}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Spain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Luxembourg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Norway}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Netherlands}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{India}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sweden}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Australasia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Finland}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SouthAfrica}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Estonia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brazil}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Japan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CzechRepublic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NewZealand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Yugoslavia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Argentina}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Uruguay}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Poland}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Haiti}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Portugal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Romania}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Egypt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ireland}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Chile}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Philippines}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mexico}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latvia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Turkey}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Jamaica}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Peru}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ceylon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TrinidadandTobago}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Panama}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SouthKorea}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iran}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PuertoRico}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lebanon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bulgaria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Venezuela}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iceland}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pakistan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bahamas}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ethiopia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ghana}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Morocco}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Singapore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BritishWestIndies}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iraq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tunisia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Kenya}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nigeria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mongolia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Uganda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cameroon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Taiwan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NorthKorea}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Colombia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Niger}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bermuda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Thailand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zimbabwe}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tanzania}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Guyana}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IvoryCoast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Syria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Algeria}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ChineseTaipei}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DominicanRepublic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zambia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Suriname}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CostaRica}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Indonesia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NetherlandsAntilles}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Senegal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{VirginIslands}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Djibouti}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{UnifiedTeam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lithuania}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Namibia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Croatia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IndependentOlympicParticipants}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Israel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Slovenia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Malaysia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qatar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Russia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ukraine}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CzechRepublic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Kazakhstan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Belarus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FRYugoslavia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Slovakia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Armenia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Burundi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ecuador}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HongKong}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Moldova}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Uzbekistan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Azerbaijan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tonga}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Georgia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mozambique}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SaudiArabia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SriLanka}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Vietnam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Barbados}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Kuwait}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Kyrgyzstan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Macedonia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{UnitedArabEmirates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SerbiaandMontenegro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paraguay}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Eritrea}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Serbia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tajikistan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Samoa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sudan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Afghanistan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mauritius}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Togo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bahrain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Grenada}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Botswana}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cyprus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gabon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Guatemala}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Montenegro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IndependentOlympicAthletes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fiji}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Jordan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Kosovo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SanMarino}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NorthMacedonia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Turkmenistan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BurkinaFaso}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SaintLucia}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dominica}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Albania}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CaboVerde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RefugeeOlympicTeam}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{]}

\PY{c+c1}{\PYZsh{} 保留当前存在的国家}
\PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{current\PYZus{}countries}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 国家合并取均值}
\PY{n}{df\PYZus{}grouped} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存数据}
\PY{n}{df\PYZus{}grouped}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 查看处理后的数据}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}grouped}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
   Year          NOC  Gold  Silver  Bronze  Total
0  1896  Afghanistan   0.0     0.0     0.0    0.0
1  1896      Albania   0.0     0.0     0.0    0.0
2  1896      Algeria   0.0     0.0     0.0    0.0
3  1896    Argentina   0.0     0.0     0.0    0.0
    \end{Verbatim}

    \subsubsection{清理athletes.csv并转换格式为宽}\label{ux6e05ux7406athletes.csvux5e76ux8f6cux6362ux683cux5f0fux4e3aux5bbd}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}athletes.csv 文件}
\PY{n}{data} \PY{o}{=} \PY{n}{olympic\PYZus{}athletes}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 转换为长格式，将年份放到列的抬头位置}
\PY{n}{pivot\PYZus{}df} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{City}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} 
                                  \PY{n}{columns}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                  \PY{n}{values}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{n}{aggfunc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值为0}
\PY{n}{pivot\PYZus{}df} \PY{o}{=} \PY{n}{pivot\PYZus{}df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{转换为宽格式后的数据：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{pivot\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存为新的 CSV 文件}
\PY{n}{output\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}athletes\PYZus{}wide\PYZus{}format.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{pivot\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{宽格式数据已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
转换为宽格式后的数据：
Year           Name Sex          Team  NOC   City          Sport  \textbackslash{}
0      (jr) Larocca   M     Argentina  ARG  Paris     Equestrian
1     . Chadalavada   F         India  IND  Tokyo        Fencing
2            . Deni   M     Indonesia  INA  Tokyo  Weightlifting
3               671   F         China  CHN  Paris       Breaking
4          A Alayed   F  Saudi Arabia  KSA  Paris       Swimming

Year                     Event 1896 1900 1904  {\ldots} 1988 1992 1996 2000 2004  \textbackslash{}
0           Jumping Individual    0    0    0  {\ldots}    0    0    0    0    0
1     Women's Sabre Individual    0    0    0  {\ldots}    0    0    0    0    0
2                   Men's 67kg    0    0    0  {\ldots}    0    0    0    0    0
3                      B-Girls    0    0    0  {\ldots}    0    0    0    0    0
4       Women's 200m Freestyle    0    0    0  {\ldots}    0    0    0    0    0

Year 2008 2012 2016      2020      2024
0       0    0    0         0  No medal
1       0    0    0  No medal         0
2       0    0    0  No medal         0
3       0    0    0         0    Bronze
4       0    0    0         0  No medal

[5 rows x 38 columns]
宽格式数据已保存到 Generated\textbackslash{}summerOly\_athletes\_wide\_format.csv
    \end{Verbatim}

    \section{分析数据}\label{ux5206ux6790ux6570ux636e}

    \subsection{国家级特征}\label{ux56fdux5bb6ux7ea7ux7279ux5f81}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{data} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 由于数据格式较为复杂，需要先将其转换为更易于处理的格式}
\PY{c+c1}{\PYZsh{} 提取年份和各个国家的奖牌总数}
\PY{c+c1}{\PYZsh{} 假设我们关注的是美国（United States）和中国的（China）奖牌总数}
\PY{n}{us\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{United States}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{US\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{china\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 合并数据}
\PY{n}{merged\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{us\PYZus{}data}\PY{p}{,} \PY{n}{china\PYZus{}data}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{US\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{United States}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加标题和图例}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Summer Olympic Medal Totals Over the Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Medals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示网格}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图表}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_24_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}imputed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 由于数据格式较为复杂，需要先将其转换为更易于处理的格式}
\PY{c+c1}{\PYZsh{} 提取年份和各个国家的奖牌总数}
\PY{c+c1}{\PYZsh{} 假设我们关注的是美国（United States）和中国的（China）奖牌总数}
\PY{n}{us\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{United States}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{US\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{china\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 合并数据}
\PY{n}{merged\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{us\PYZus{}data}\PY{p}{,} \PY{n}{china\PYZus{}data}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{US\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{United States}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{China}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加标题和图例}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Summer Olympic Medal Totals Over the Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total Medals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示网格}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图表}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{项目级特征}\label{ux9879ux76eeux7ea7ux7279ux5f81}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{171}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}programs\PYZus{}filled.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 获取所有年份列}
\PY{n}{years} \PY{o}{=} \PY{p}{[}\PY{n}{col} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{n}{col}\PY{o}{.}\PY{n}{isdigit}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 初始化一个空的DataFrame来存储结果}
\PY{n}{result} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 遍历每个年份，计算总项目数}
\PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{years}\PY{p}{:}
    \PY{n}{total\PYZus{}events} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{year}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
    \PY{n}{new\PYZus{}row} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{year}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{total\PYZus{}events}\PY{p}{)}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}
    \PY{n}{result} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{result}\PY{p}{,} \PY{n}{new\PYZus{}row}\PY{p}{]}\PY{p}{,} \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{result}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{n}{result}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Project\PYZus{}amount.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
   Year Amount
0  1896    113
1  1900    236
2  1904    224
3  1906    176
4  1908    267
    \end{Verbatim}

    \subsubsection{可视化}\label{ux53efux89c6ux5316}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Project\PYZus{}amount.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 设置图形大小}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 绘制折线图，添加标记点}

\PY{c+c1}{\PYZsh{} 添加标题和标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Olympic Events Over the Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 添加标题}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 添加x轴标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount of Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 添加y轴标签}

\PY{c+c1}{\PYZsh{} 添加网格线}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.6}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图形}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_29_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{线性拟合}\label{ux7ebfux6027ux62dfux5408}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{177}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{r2\PYZus{}score}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Project\PYZus{}amount.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 准备数据}
\PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 将年份作为自变量}
\PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}  \PY{c+c1}{\PYZsh{} 将项目数作为因变量}

\PY{c+c1}{\PYZsh{} 创建线性回归模型}
\PY{n}{model} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 拟合模型}
\PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 预测2028年的总项目数}
\PY{n}{year\PYZus{}2028} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{predicted\PYZus{}amount\PYZus{}2028} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算决定系数 R\PYZca{}2}
\PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\PY{n}{r2} \PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图和拟合线}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual Data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 绘制实际数据}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fitted Line}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 绘制拟合线}

\PY{c+c1}{\PYZsh{} 添加标题和标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Olympic Events Over the Years with Linear Regression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount of Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加网格线}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.6}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加图例}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图形}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 打印预测结果和拟合度}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年的总项目数: }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{round}\PY{p}{(}\PY{n}{predicted\PYZus{}amount\PYZus{}2028}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{决定系数 R\PYZca{}2: }\PY{l+s+si}{\PYZob{}}\PY{n}{r2}\PY{l+s+si}{:}\PY{l+s+s2}{.4f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_31_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
预测2028年的总项目数: 721
决定系数 R\^{}2: 0.9177
    \end{Verbatim}

    \subsection{运动员级特征}\label{ux8fd0ux52a8ux5458ux7ea7ux7279ux5f81}

    \subsubsection{预处理}\label{ux9884ux5904ux7406}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取 summerOly\PYZus{}athletes.csv 文件}
\PY{n}{data} \PY{o}{=} \PY{n}{olympic\PYZus{}athletes}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 提取必要的列}
\PY{n}{athlete\PYZus{}years} \PY{o}{=} \PY{n}{olympic\PYZus{}athletes}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}
\PY{c+c1}{\PYZsh{} 合并Name, Sex, NOC列}
\PY{n}{athlete\PYZus{}years}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{athlete\PYZus{}years}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{athlete\PYZus{}years}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{athlete\PYZus{}years}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 删除原始的Name, Sex, NOC列}
\PY{c+c1}{\PYZsh{}athlete\PYZus{}years = athlete\PYZus{}years.drop(columns=[\PYZsq{}Name\PYZsq{}, \PYZsq{}Sex\PYZsq{}, \PYZsq{}NOC\PYZsq{}])}

\PY{c+c1}{\PYZsh{} 对每个运动员进行排序}
\PY{n}{athlete\PYZus{}years} \PY{o}{=} \PY{n}{athlete\PYZus{}years}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{athlete\PYZus{}years}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}yesrs.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{添加唯一特征值}\label{ux6dfbux52a0ux552fux4e00ux7279ux5f81ux503c}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{os}

\PY{c+c1}{\PYZsh{} 设置环境变量 LOKY\PYZus{}MAX\PYZus{}CPU\PYZus{}COUNT}
\PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LOKY\PYZus{}MAX\PYZus{}CPU\PYZus{}COUNT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{8}\PY{l+s+s2}{\PYZdq{}}  \PY{c+c1}{\PYZsh{} 使用CPU 核心数}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{DBSCAN}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{StandardScaler}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}yesrs.csv}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} 替换为你的文件路径}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示原始数据的前几行}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{原始数据的前几行：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 设置时间阈值}
\PY{n}{time\PYZus{}threshold\PYZus{}small} \PY{o}{=} \PY{l+m+mi}{12}
\PY{n}{time\PYZus{}threshold\PYZus{}large} \PY{o}{=} \PY{l+m+mi}{44}

\PY{c+c1}{\PYZsh{} 按Feature分组}
\PY{n}{grouped} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 用于存储处理后的数据}
\PY{n}{processed\PYZus{}data} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 遍历每个分组}
\PY{k}{for} \PY{n}{feature}\PY{p}{,} \PY{n}{group} \PY{o+ow}{in} \PY{n}{grouped}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 按Year排序}
    \PY{n}{group} \PY{o}{=} \PY{n}{group}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} 初始化变量}
    \PY{n}{unique\PYZus{}feature\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{last\PYZus{}year} \PY{o}{=} \PY{k+kc}{None}
    
    \PY{c+c1}{\PYZsh{} 遍历分组中的每条记录}
    \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{group}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{n}{current\PYZus{}year} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} 判断是否为同一个运动员}
        \PY{k}{if} \PY{n}{last\PYZus{}year} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{year\PYZus{}diff} \PY{o}{=} \PY{n}{current\PYZus{}year} \PY{o}{\PYZhy{}} \PY{n}{last\PYZus{}year}
            \PY{k}{if} \PY{n}{year\PYZus{}diff} \PY{o}{\PYZgt{}} \PY{n}{time\PYZus{}threshold\PYZus{}large}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 如果时间跨度大于44年，直接认为是不同运动员}
                \PY{n}{unique\PYZus{}feature\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
            \PY{k}{elif} \PY{n}{year\PYZus{}diff} \PY{o}{\PYZgt{}} \PY{n}{time\PYZus{}threshold\PYZus{}small}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 如果时间跨度在12到44年之间，进行聚类分析}
                \PY{n}{features\PYZus{}cluster} \PY{o}{=} \PY{n}{group}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{factorize}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                \PY{n}{features\PYZus{}cluster} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{features\PYZus{}cluster}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} 使用DBSCAN聚类}
                \PY{n}{dbscan} \PY{o}{=} \PY{n}{DBSCAN}\PY{p}{(}\PY{n}{eps}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{min\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
                \PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dbscan}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{features\PYZus{}cluster}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} 为每个聚类生成唯一标识}
                \PY{k}{for} \PY{n}{cluster} \PY{o+ow}{in} \PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                    \PY{n}{cluster\PYZus{}group} \PY{o}{=} \PY{n}{group}\PY{p}{[}\PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{cluster}\PY{p}{]}
                    \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{cluster\PYZus{}row} \PY{o+ow}{in} \PY{n}{cluster\PYZus{}group}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                        \PY{n}{new\PYZus{}feature} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{feature}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{cluster}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}
                        \PY{n}{processed\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{cluster\PYZus{}row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{new\PYZus{}feature}
                        \PY{p}{\PYZcb{}}\PY{p}{)}
                        \PY{n}{unique\PYZus{}feature\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{break}  \PY{c+c1}{\PYZsh{} 已经处理完当前分组，跳出循环}
        
        \PY{c+c1}{\PYZsh{} 如果时间跨度在阈值内，认为是同一个运动员}
        \PY{n}{new\PYZus{}feature} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{feature}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{unique\PYZus{}feature\PYZus{}count}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{processed\PYZus{}data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Team}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{new\PYZus{}feature}
        \PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 更新变量}
        \PY{n}{last\PYZus{}year} \PY{o}{=} \PY{n}{current\PYZus{}year}

\PY{c+c1}{\PYZsh{} 将处理后的数据转换为DataFrame}
\PY{n}{processed\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{processed\PYZus{}data}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示处理后的数据}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{处理后的数据：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Event}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存处理后的数据到新的CSV文件}
\PY{n}{output\PYZus{}file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}years\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{processed\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}file\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{处理后的数据已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}file\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
原始数据的前几行：
            Name Sex  NOC          Team  Year          Sport  \textbackslash{}
0   (jr) Larocca   M  ARG     Argentina  2024     Equestrian
1  . Chadalavada   F  IND         India  2020        Fencing
2         . Deni   M  INA     Indonesia  2020  Weightlifting
3            671   F  CHN         China  2024       Breaking
4       A Alayed   F  KSA  Saudi Arabia  2024       Swimming

                      Event                Feature
0        Jumping Individual   (jr) Larocca, M, ARG
1  Women's Sabre Individual  . Chadalavada, F, IND
2                Men's 67kg         . Deni, M, INA
3                   B-Girls            671, F, CHN
4    Women's 200m Freestyle       A Alayed, F, KSA

处理后的数据：
                   Feature          Sport                     Event  Year
0   (jr) Larocca, M, ARG\_0     Equestrian        Jumping Individual  2024
1  . Chadalavada, F, IND\_0        Fencing  Women's Sabre Individual  2020
2         . Deni, M, INA\_0  Weightlifting                Men's 67kg  2020
3            671, F, CHN\_0       Breaking                   B-Girls  2024
4       A Alayed, F, KSA\_0       Swimming    Women's 200m Freestyle  2024

处理后的数据已保存到 Generated\textbackslash{}athlete\_years\_processed.csv
    \end{Verbatim}

    \subsubsection{统计连续参加奥运会的年数与对应人数}\label{ux7edfux8ba1ux8fdeux7eedux53c2ux52a0ux5965ux8fd0ux4f1aux7684ux5e74ux6570ux4e0eux5bf9ux5e94ux4ebaux6570}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}years\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} 替换为你的文件路径}
\PY{n}{athlete\PYZus{}years} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 计算连续参加的届数}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{count\PYZus{}consecutive\PYZus{}years}\PY{p}{(}\PY{n}{group}\PY{p}{)}\PY{p}{:}
    \PY{n}{years} \PY{o}{=} \PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}
    \PY{n}{consecutive\PYZus{}year} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{n}{current\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{years}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{years}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{years}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{6} \PY{p}{:}
            \PY{k}{if} \PY{n}{years}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{years}\PY{p}{[}\PY{n}{i} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{3}\PY{p}{:}
                \PY{n}{current\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n}{current\PYZus{}count} \PY{o}{\PYZgt{}} \PY{l+m+mi}{10}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{group}\PY{p}{)}
            \PY{n}{consecutive\PYZus{}year}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{current\PYZus{}count}\PY{p}{)}
            \PY{n}{current\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{consecutive\PYZus{}year}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{current\PYZus{}count}\PY{p}{)}
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{consecutive\PYZus{}year}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 应用函数计算每个运动员的连续届数}
\PY{n}{consecutive\PYZus{}years} \PY{o}{=} \PY{n}{athlete\PYZus{}years}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{count\PYZus{}consecutive\PYZus{}years}\PY{p}{,} \PY{n}{include\PYZus{}groups}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{explode}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{consecutive\PYZus{}years}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consecutive\PYZus{}Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 修正列名}
\PY{n}{consecutive\PYZus{}years} \PY{o}{=} \PY{n}{consecutive\PYZus{}years}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level\PYZus{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 删除不必要的列}

\PY{c+c1}{\PYZsh{} 统计每个连续届数的人数}
\PY{n}{consecutive\PYZus{}years\PYZus{}count} \PY{o}{=} \PY{n}{consecutive\PYZus{}years}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consecutive\PYZus{}Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{consecutive\PYZus{}years\PYZus{}count}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consecutive\PYZus{}Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{连续参加奥运会的届数与对应人次：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{consecutive\PYZus{}years\PYZus{}count}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存为新的 CSV 文件}
\PY{n}{output\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{consecutive\PYZus{}years\PYZus{}count.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{consecutive\PYZus{}years\PYZus{}count}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{统计结果已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
连续参加奥运会的届数与对应人次：
   Consecutive\_Years   Count
0                  1  108202
1                  2   23470
2                  3    6036
3                  4    1575
4                  5     372
5                  6      79
6                  7      18
7                  8       4
8                  9       1
统计结果已保存到 Generated\textbackslash{}consecutive\_years\_count.csv
    \end{Verbatim}

    \paragraph{数据可视化}\label{ux6570ux636eux53efux89c6ux5316}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入必要的库}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{font\PYZus{}manager}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{FontProperties}

\PY{c+c1}{\PYZsh{} 设置支持中文的字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.sans\PYZhy{}serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SimHei}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 使用黑体字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.unicode\PYZus{}minus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}  \PY{c+c1}{\PYZsh{} 解决负号显示问题}

\PY{c+c1}{\PYZsh{} 读取数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Generated/consecutive\PYZus{}years\PYZus{}count.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义大致届数区间}
\PY{n}{bins} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{]}
\PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1次}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2次}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3次}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4次及以上}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 将数据分组到区间}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consecutive\PYZus{}Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{n}{bins}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{labels}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算每个区间的总人次，显式设置 observed=True}
\PY{n}{grouped\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{observed}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 准备绘图数据}
\PY{n}{labels} \PY{o}{=} \PY{n}{grouped\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{sizes} \PY{o}{=} \PY{n}{grouped\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ff9999}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}66b3ff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}66ccff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}99ff99}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 颜色列表}

\PY{c+c1}{\PYZsh{} 绘制饼图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\PY{n}{wedges}\PY{p}{,} \PY{n}{texts}\PY{p}{,} \PY{n}{autotexts} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{pie}\PY{p}{(}\PY{n}{sizes}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{autopct}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{startangle}\PY{o}{=}\PY{l+m+mi}{140}\PY{p}{,} \PY{n}{textprops}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加图例（色块+标签），放置在右侧}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{wedges}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{连续参加届数}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{center left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{连续参加奥运会届数的扇形比例图}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 确保饼图是圆形}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_42_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 保存组别与对应比例}
\PY{n}{group\PYZus{}percentages} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{label}\PY{p}{,} \PY{n}{autotext} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{autotexts}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 获取百分比文本并去掉百分号，转换为浮点数}
    \PY{n}{percentage} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{autotext}\PY{o}{.}\PY{n}{get\PYZus{}text}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
    \PY{n}{group\PYZus{}percentages}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{label}\PY{p}{,} \PY{n}{percentage}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 打印结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{组别与对应比例：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{group}\PY{p}{,} \PY{n}{percentage} \PY{o+ow}{in} \PY{n}{group\PYZus{}percentages}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{group}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{percentage}\PY{l+s+si}{:}\PY{l+s+s2}{.1f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
组别与对应比例：
1次: 77.4\%
2次: 16.8\%
3次: 4.3\%
4次及以上: 1.5\%
    \end{Verbatim}

    \subsubsection{统计运动员参加奥运会的时间跨度}\label{ux7edfux8ba1ux8fd0ux52a8ux5458ux53c2ux52a0ux5965ux8fd0ux4f1aux7684ux65f6ux95f4ux8de8ux5ea6}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}years\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} 替换为你的文件路径}
\PY{n}{athlete\PYZus{}years} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 计算每个运动员的第一次和最后一次参赛年份}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{calculate\PYZus{}year\PYZus{}gap}\PY{p}{(}\PY{n}{group}\PY{p}{)}\PY{p}{:}
    \PY{n}{years} \PY{o}{=} \PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
    \PY{n}{min\PYZus{}n} \PY{o}{=} \PY{l+m+mi}{2032}
    \PY{n}{max\PYZus{}n} \PY{o}{=} \PY{l+m+mi}{1896}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{years}\PY{p}{:}
        \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n}{min\PYZus{}n}\PY{p}{:}
            \PY{n}{min\PYZus{}n} \PY{o}{=} \PY{n}{i}
        \PY{k}{if} \PY{n}{i} \PY{o}{\PYZgt{}} \PY{n}{max\PYZus{}n}\PY{p}{:}
            \PY{n}{max\PYZus{}n} \PY{o}{=} \PY{n}{i}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{years}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{k}{if} \PY{n}{max\PYZus{}n} \PY{o}{\PYZhy{}} \PY{n}{min\PYZus{}n} \PY{o}{+} \PY{l+m+mi}{1} \PY{o}{\PYZgt{}} \PY{l+m+mi}{60}\PY{p}{:}
            \PY{c+c1}{\PYZsh{}print(group)}
            \PY{k}{return} \PY{l+m+mi}{1}
        \PY{k}{return} \PY{n}{max\PYZus{}n} \PY{o}{\PYZhy{}} \PY{n}{min\PYZus{}n} \PY{o}{+} \PY{l+m+mi}{1}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{return} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} 应用函数计算每个运动员的间隔年数}
\PY{n}{athlete\PYZus{}gaps} \PY{o}{=} \PY{n}{athlete\PYZus{}years}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{calculate\PYZus{}year\PYZus{}gap}\PY{p}{,} \PY{n}{include\PYZus{}groups}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{athlete\PYZus{}gaps}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 统计每个间隔年数的人数}
\PY{n}{gap\PYZus{}counts} \PY{o}{=} \PY{n}{athlete\PYZus{}gaps}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{gap\PYZus{}counts}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 按 Year\PYZus{}Gap 排序}
\PY{n}{gap\PYZus{}counts} \PY{o}{=} \PY{n}{gap\PYZus{}counts}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{运动员第一次参加奥运会和最后一次参加奥运会之间的间隔年数：}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{gap\PYZus{}counts}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存为新的 CSV 文件}
\PY{n}{output\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}year\PYZus{}gaps.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{gap\PYZus{}counts}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{统计结果已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
运动员第一次参加奥运会和最后一次参加奥运会之间的间隔年数：
    Year\_Gap  Count
0          1  99249
8          3     98
1          5  21869
10         7     77
2          9   8014
18        11     12
3         13   2887
15        15     16
4         17    942
19        19      8
5         21    382
20        23      3
6         25    178
21        27      1
7         29    134
22        31      1
9         33     90
11        37     57
12        41     49
24        43      1
13        45     44
14        49     21
17        53     12
16        57     13
23        59      1
统计结果已保存到 Generated\textbackslash{}athlete\_year\_gaps.csv
    \end{Verbatim}

    \paragraph{数据可视化}\label{ux6570ux636eux53efux89c6ux5316}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入必要的库}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}

\PY{c+c1}{\PYZsh{} 设置支持中文的字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.sans\PYZhy{}serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SimHei}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 使用黑体字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.unicode\PYZus{}minus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}  \PY{c+c1}{\PYZsh{} 解决负号显示问题}

\PY{c+c1}{\PYZsh{} 读取数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s2}{athlete\PYZus{}year\PYZus{}gaps.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义大致间隔年数区间}
\PY{n}{bins} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{120}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 区间划分：0\PYZhy{}5年，5\PYZhy{}10年，10\PYZhy{}15年，15\PYZhy{}20年，20\PYZhy{}30年，30年以上}
\PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0\PYZhy{}5年}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5\PYZhy{}10年}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10\PYZhy{}15年}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{15\PYZhy{}20年}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{20\PYZhy{}30年}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{30年以上}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 将数据分组到区间}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{n}{bins}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{labels}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算每个区间的总人次}
\PY{n}{grouped\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{observed}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 准备绘图数据}
\PY{n}{labels} \PY{o}{=} \PY{n}{grouped\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{sizes} \PY{o}{=} \PY{n}{grouped\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{colors} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{viridis}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{labels}\PY{p}{)}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 使用颜色映射生成颜色列表}

\PY{c+c1}{\PYZsh{} 绘制饼图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\PY{n}{wedges}\PY{p}{,} \PY{n}{texts}\PY{p}{,} \PY{n}{autotexts} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{pie}\PY{p}{(}\PY{n}{sizes}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{autopct}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{startangle}\PY{o}{=}\PY{l+m+mi}{140}\PY{p}{,} \PY{n}{textprops}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加图例（色块+标签），放置在右侧}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{wedges}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{间隔年数区间}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{center left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{运动员第一次参加奥运会和最后一次参加奥运会之间的间隔年数比例图}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 确保饼图是圆形}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_48_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    '\,`'根据扇形图，对于运动员连续参加比赛，只考虑连续参加2-3届的运动员的连续性影响，其余影响可以忽略不计。'\,'\,'

    \paragraph{参加时间跨度为0-15年的运动员中连续参加的比例}\label{ux53c2ux52a0ux65f6ux95f4ux8de8ux5ea6ux4e3a0-15ux5e74ux7684ux8fd0ux52a8ux5458ux4e2dux8fdeux7eedux53c2ux52a0ux7684ux6bd4ux4f8b}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 合并时间跨度和连续届数数据}
\PY{n}{athlete\PYZus{}gaps}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{athlete\PYZus{}gaps.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{consecutive\PYZus{}years}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{consecutive\PYZus{}years.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{merged\PYZus{}data} \PY{o}{=} \PY{n}{athlete\PYZus{}gaps}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{consecutive\PYZus{}years}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 筛选出时间跨度为1\PYZhy{}15年的运动员}
\PY{n}{filtered\PYZus{}data} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 统计连续参加的比例}
\PY{n}{total\PYZus{}count} \PY{o}{=} \PY{n}{filtered\PYZus{}data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{consecutive\PYZus{}count} \PY{o}{=} \PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year\PYZus{}Gap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consecutive\PYZus{}Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{consecutive\PYZus{}ratio} \PY{o}{=} \PY{n}{consecutive\PYZus{}count} \PY{o}{/} \PY{n}{total\PYZus{}count} \PY{k}{if} \PY{n}{total\PYZus{}count} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} 输出结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{时间跨度为1\PYZhy{}15年的运动员中，连续参加的比例为：}\PY{l+s+si}{\PYZob{}}\PY{n}{consecutive\PYZus{}ratio}\PY{l+s+si}{:}\PY{l+s+s2}{.2\PYZpc{}}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存结果到 CSV 文件}
\PY{n}{output\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{consecutive\PYZus{}ratio.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{filtered\PYZus{}data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}path}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{统计结果已保存到 }\PY{l+s+si}{\PYZob{}}\PY{n}{output\PYZus{}path}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
时间跨度为1-15年的运动员中，连续参加的比例为：94.51\%
统计结果已保存到 Generated\textbackslash{}consecutive\_ratio.csv
    \end{Verbatim}

    \paragraph{数据可视化}\label{ux6570ux636eux53efux89c6ux5316}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入必要的库}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 设置支持中文的字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.sans\PYZhy{}serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SimHei}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 使用黑体字体}
\PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.unicode\PYZus{}minus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}  \PY{c+c1}{\PYZsh{} 解决负号显示问题}

\PY{c+c1}{\PYZsh{} 数据}
\PY{n}{percentages} \PY{o}{=} \PY{p}{[}\PY{n}{consecutive\PYZus{}ratio}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{consecutive\PYZus{}ratio}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 一个百分数和剩余部分}
\PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{continuous}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not continuous}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 标签}
\PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}66ccff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}66b3ff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} 颜色}

\PY{c+c1}{\PYZsh{} 绘制饼图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 设置图形大小}
\PY{n}{plt}\PY{o}{.}\PY{n}{pie}\PY{p}{(}\PY{n}{percentages}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{labels}\PY{p}{,} \PY{n}{colors}\PY{o}{=}\PY{n}{colors}\PY{p}{,} \PY{n}{autopct}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}1.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{startangle}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{)}
\PY{c+c1}{\PYZsh{} autopct=\PYZsq{}\PYZpc{}1.2f\PYZpc{}\PYZpc{}\PYZsq{} 表示在每个扇形上显示百分比，格式为2位小数}
\PY{c+c1}{\PYZsh{} startangle=90 表示从90度（即正上方）开始绘制}

\PY{c+c1}{\PYZsh{} 添加标题}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{参加时间跨度为0\PYZhy{}15年的运动员中连续参加的比例}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图形}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_53_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{结论}\label{ux7ed3ux8bba}

\begin{itemize}
\tightlist
\item
  `我们可以发现，参加奥运会时间跨度0-15年中绝大部分运动员都是连续参加的'
\item
  `而且我们前面发现，绝大部分的运动员的时间跨度在0-15年之间，连续参加届数在1-3届'
\item
  `而且我们知道，0-15之间只能连续参加1-3次奥运会'
\item
  `我们因此可以得出结论，绝大部分奥运会运动员连续参加了1-3次奥运会'
\item
  `所以我们可以得出结论，考虑运动员连续参加比赛对奖牌的影响只需要考虑连续参加2-3次的情况'
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{first\PYZus{}percentage} \PY{o}{=} \PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{/}\PY{p}{(}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{一个参加了一次奥运会的运动员参加下一次奥运会的可能为}\PY{l+s+si}{\PYZob{}}\PY{n}{first\PYZus{}percentage}\PY{+w}{ }\PY{l+s+si}{:}\PY{l+s+s1}{ .2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{second\PYZus{}percentage} \PY{o}{=} \PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{/}\PY{p}{(}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{一个参加了两次奥运会的运动员参加下一次奥运会的可能为}\PY{l+s+si}{\PYZob{}}\PY{n}{second\PYZus{}percentage}\PY{+w}{ }\PY{l+s+si}{:}\PY{l+s+s1}{ .2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{third\PYZus{}percentage} \PY{o}{=} \PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{/}\PY{p}{(}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{n}{group\PYZus{}percentages}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{一个参加了三次奥运会的运动员参加下一次奥运会的可能为}\PY{l+s+si}{\PYZob{}}\PY{n}{third\PYZus{}percentage}\PY{+w}{ }\PY{l+s+si}{:}\PY{l+s+s1}{ .2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{athlete\PYZus{}join\PYZus{}willing} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1} \PY{p}{:} \PY{n}{first\PYZus{}percentage}\PY{p}{,} \PY{l+m+mi}{2} \PY{p}{:} \PY{n}{second\PYZus{}percentage}\PY{p}{,} \PY{l+m+mi}{3} \PY{p}{:} \PY{n}{third\PYZus{}percentage}\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
一个参加了一次奥运会的运动员参加下一次奥运会的可能为 16.80\%
一个参加了两次奥运会的运动员参加下一次奥运会的可能为 19.03\%
一个参加了三次奥运会的运动员参加下一次奥运会的可能为 25.86\%
    \end{Verbatim}

    \section{构建模型}\label{ux6784ux5efaux6a21ux578b}

    \subsection{XGBoost}\label{xgboost}

    \subsubsection{直接预测（超参数优化）}\label{ux76f4ux63a5ux9884ux6d4bux8d85ux53c2ux6570ux4f18ux5316}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{xgboost}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{XGBRegressor}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{,} \PY{n}{GridSearchCV}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LabelEncoder}

\PY{c+c1}{\PYZsh{}scikit\PYZhy{}learn==1.5.2}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 将国家代码转换为数值标签}
\PY{n}{label\PYZus{}encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 处理缺失值}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建特征：前一届奥运会的奖牌总数、金牌数、银牌数、铜牌数}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 选择特征和目标变量}
\PY{n}{features} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{target\PYZus{}total} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}gold} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}silver} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}bronze} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 划分训练集和测试集}
\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}total}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}gold}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}silver}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}bronze}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}

\PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{]}\PY{p}{,}
          \PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{y\PYZus{}test\PYZus{}total}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{y\PYZus{}test\PYZus{}gold}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{y\PYZus{}test\PYZus{}silver}\PY{p}{]}\PY{p}{,}
          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{n}{y\PYZus{}test\PYZus{}bronze}\PY{p}{]}\PY{p}{,}
          \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 启用 GPU 加速}
\PY{n}{params} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{c+c1}{\PYZsh{}\PYZsq{}tree\PYZus{}method\PYZsq{} : \PYZdq{}hist\PYZdq{},}
    \PY{c+c1}{\PYZsh{}\PYZsq{}device\PYZsq{} : \PYZdq{}cuda\PYZdq{},}
    \PY{c+c1}{\PYZsh{}\PYZsq{}predictor\PYZsq{}: \PYZsq{}gpu\PYZus{}predictor\PYZsq{},  \PYZsh{} 使用 GPU 进行预测}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{objective}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random\PYZus{}state}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{42}\PY{l+s+s1}{\PYZsq{}}
\PY{p}{\PYZcb{}}


\PY{c+c1}{\PYZsh{} 定义XGBoost模型}
\PY{n}{model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
\PY{n}{model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
\PY{n}{model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
\PY{n}{model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 超参数优化}
\PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{150}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 使用GridSearchCV进行超参数优化}
\PY{n}{grid\PYZus{}search\PYZus{}total} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}total}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}gold}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}silver}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}bronze}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 训练模型}
\PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 获取最佳模型}
\PY{n}{best\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}

\PY{c+c1}{\PYZsh{} 评估模型}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{mse} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE: }\PY{l+s+si}{\PYZob{}}\PY{n}{mse}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{n}{y\PYZus{}pred}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gold Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Silver Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bronze Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义超参数网格}
\PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{150}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{colsample\PYZus{}bytree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 为每个国家单独训练模型}
\PY{n}{country\PYZus{}models} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 确保每个国家至少有两条记录}
        \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 替换无穷值为NaN}
        \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{ffill}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 前向填充}
        \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{o}{.}\PY{n}{bfill}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 后向填充}
        \PY{n}{country\PYZus{}features} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{n}{country\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{params}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} 使用GridSearchCV进行超参数优化}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{country\PYZus{}model\PYZus{}total}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{country\PYZus{}model\PYZus{}gold}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{country\PYZus{}model\PYZus{}silver}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{country\PYZus{}model\PYZus{}bronze}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}total}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}gold}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}silver}\PY{p}{)}
        \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}bronze}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} 获取最佳模型}
        \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
        \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
        \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
        \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}country\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
        
        \PY{c+c1}{\PYZsh{} 评估性能}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gold Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Silver Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bronze Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze}\PY{p}{)}

        \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}total}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}gold}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}silver}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{best\PYZus{}country\PYZus{}model\PYZus{}bronze}
        \PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 预测2028年奥运会的奖牌数}
\PY{n}{next\PYZus{}year} \PY{o}{=} \PY{l+m+mi}{2028}
\PY{n}{predictions} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{prev\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{next\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{next\PYZus{}year}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}total}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}gold}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}silver}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}bronze}\PY{p}{]}
        \PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用单独模型预测}
        \PY{n}{total\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用整体模型预测}
        \PY{n}{total\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 根据数据量分配权重}
        \PY{n}{data\PYZus{}count} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)}
        \PY{n}{weight} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{data\PYZus{}count} \PY{o}{/} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 数据量越多，权重越高，但不超过1}
        \PY{n}{total\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{total\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{total\PYZus{}pred\PYZus{}global}
        \PY{n}{gold\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{gold\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{gold\PYZus{}pred\PYZus{}global}
        \PY{n}{silver\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{silver\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{silver\PYZus{}pred\PYZus{}global}
        \PY{n}{bronze\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{bronze\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{bronze\PYZus{}pred\PYZus{}global}
        
        \PY{c+c1}{\PYZsh{} 对预测结果取整}
        \PY{n}{total\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{n}{predictions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{total\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{gold\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{silver\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{bronze\PYZus{}pred\PYZus{}combined}
        \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将预测结果转换为DataFrame}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{predictions}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将NOC标签转换回国家代码}
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存预测结果到CSV文件}
\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Total Medals Model Evaluation:
MSE: 14.183948320207696
Gold Medals Model Evaluation:
MSE: 2.9414593946059715
Silver Medals Model Evaluation:
MSE: 1.8287626291987034
Bronze Medals Model Evaluation:
MSE: 2.185780634244944
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
c:\textbackslash{}Users\textbackslash{}Ziqi\textbackslash{}Documents\textbackslash{}Python\textbackslash{}2025-MCM-C\textbackslash{}new\_env\textbackslash{}Lib\textbackslash{}site-
packages\textbackslash{}numpy\textbackslash{}ma\textbackslash{}core.py:2892: RuntimeWarning: invalid value encountered in
cast
  \_data = np.array(data, dtype=dtype, copy=copy,
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Total Medals Model Evaluation:
MSE: 140.75342068015084
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 15.818427348076781
Total Medals Model Evaluation:
MSE: 142.85282353556897
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.57628960602166
Total Medals Model Evaluation:
MSE: 122.58495074211991
Gold Medals Model Evaluation:
MSE: 17.402119733106872
Silver Medals Model Evaluation:
MSE: 14.068511301831862
Bronze Medals Model Evaluation:
MSE: 12.350547132239438
Total Medals Model Evaluation:
MSE: 117.61289573977655
Gold Medals Model Evaluation:
MSE: 15.07693219210729
Silver Medals Model Evaluation:
MSE: 13.564828598561522
Bronze Medals Model Evaluation:
MSE: 14.238776584657261
Total Medals Model Evaluation:
MSE: 129.11978398983476
Gold Medals Model Evaluation:
MSE: 18.434324148292763
Silver Medals Model Evaluation:
MSE: 14.228132612839607
Bronze Medals Model Evaluation:
MSE: 14.471448380309658
Total Medals Model Evaluation:
MSE: 124.98686516532699
Gold Medals Model Evaluation:
MSE: 16.651968965013406
Silver Medals Model Evaluation:
MSE: 13.778019188979943
Bronze Medals Model Evaluation:
MSE: 14.139838236770917
Total Medals Model Evaluation:
MSE: 358.80440175013155
Gold Medals Model Evaluation:
MSE: 20.563497436255997
Silver Medals Model Evaluation:
MSE: 14.728424680409017
Bronze Medals Model Evaluation:
MSE: 62.151548453599624
Total Medals Model Evaluation:
MSE: 121.52328745335026
Gold Medals Model Evaluation:
MSE: 17.08826741405428
Silver Medals Model Evaluation:
MSE: 8.456780684764317
Bronze Medals Model Evaluation:
MSE: 13.800333944030273
Total Medals Model Evaluation:
MSE: 121.28168772713842
Gold Medals Model Evaluation:
MSE: 17.188011597117296
Silver Medals Model Evaluation:
MSE: 12.243500658956734
Bronze Medals Model Evaluation:
MSE: 13.01291421240365
Total Medals Model Evaluation:
MSE: 135.42778365851981
Gold Medals Model Evaluation:
MSE: 16.491949999900445
Silver Medals Model Evaluation:
MSE: 15.715501421589924
Bronze Medals Model Evaluation:
MSE: 15.425882914340793
Total Medals Model Evaluation:
MSE: 136.0125892999167
Gold Medals Model Evaluation:
MSE: 17.489983416107265
Silver Medals Model Evaluation:
MSE: 14.761046310429055
Bronze Medals Model Evaluation:
MSE: 16.594110127403372
Total Medals Model Evaluation:
MSE: 141.87124104542065
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.243400642547297
Total Medals Model Evaluation:
MSE: 120.71016681843432
Gold Medals Model Evaluation:
MSE: 15.787307093399031
Silver Medals Model Evaluation:
MSE: 14.19017143798728
Bronze Medals Model Evaluation:
MSE: 13.257024386223838
Total Medals Model Evaluation:
MSE: 147.57950644741916
Gold Medals Model Evaluation:
MSE: 18.25579859115117
Silver Medals Model Evaluation:
MSE: 18.632453573025572
Bronze Medals Model Evaluation:
MSE: 14.94270892045927
Total Medals Model Evaluation:
MSE: 139.6394026306558
Gold Medals Model Evaluation:
MSE: 17.767295402724574
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.460522670790425
Total Medals Model Evaluation:
MSE: 139.35187215005126
Gold Medals Model Evaluation:
MSE: 17.88929933233542
Silver Medals Model Evaluation:
MSE: 14.974081675585804
Bronze Medals Model Evaluation:
MSE: 16.854725073108664
Total Medals Model Evaluation:
MSE: 101.07380992388109
Gold Medals Model Evaluation:
MSE: 15.216573986366383
Silver Medals Model Evaluation:
MSE: 10.614158888550097
Bronze Medals Model Evaluation:
MSE: 17.021541084900498
Total Medals Model Evaluation:
MSE: 137.91288893522758
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 15.049108389021708
Total Medals Model Evaluation:
MSE: 61.34089209055521
Gold Medals Model Evaluation:
MSE: 10.549011817980551
Silver Medals Model Evaluation:
MSE: 7.605056533916365
Bronze Medals Model Evaluation:
MSE: 7.2707636253885966
Total Medals Model Evaluation:
MSE: 142.02179006561525
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.237062975312316
Total Medals Model Evaluation:
MSE: 139.3351760873514
Gold Medals Model Evaluation:
MSE: 18.035994408118114
Silver Medals Model Evaluation:
MSE: 14.73899526655078
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 143.3969044824103
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.724709920071003
Total Medals Model Evaluation:
MSE: 139.34559437757136
Gold Medals Model Evaluation:
MSE: 17.214406951374524
Silver Medals Model Evaluation:
MSE: 15.212162587307901
Bronze Medals Model Evaluation:
MSE: 16.490335383368734
Total Medals Model Evaluation:
MSE: 137.43044956221405
Gold Medals Model Evaluation:
MSE: 14.082064906186895
Silver Medals Model Evaluation:
MSE: 18.99416929276979
Bronze Medals Model Evaluation:
MSE: 13.800402129408212
Total Medals Model Evaluation:
MSE: 142.49664552351146
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.023011600995122
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 133.4642191773885
Gold Medals Model Evaluation:
MSE: 17.355501671116315
Silver Medals Model Evaluation:
MSE: 13.540156929741585
Bronze Medals Model Evaluation:
MSE: 15.426952193809083
Total Medals Model Evaluation:
MSE: 1059.2390573782006
Gold Medals Model Evaluation:
MSE: 217.9136816957673
Silver Medals Model Evaluation:
MSE: 65.1023815429746
Bronze Medals Model Evaluation:
MSE: 61.27728020539144
Total Medals Model Evaluation:
MSE: 120.7995675082242
Gold Medals Model Evaluation:
MSE: 15.957535261561022
Silver Medals Model Evaluation:
MSE: 14.024219968829057
Bronze Medals Model Evaluation:
MSE: 12.974846857613437
Total Medals Model Evaluation:
MSE: 114.4462319617079
Gold Medals Model Evaluation:
MSE: 14.065858206775063
Silver Medals Model Evaluation:
MSE: 12.038611154448432
Bronze Medals Model Evaluation:
MSE: 12.862802915832578
Total Medals Model Evaluation:
MSE: 134.83039375503853
Gold Medals Model Evaluation:
MSE: 18.518730006912765
Silver Medals Model Evaluation:
MSE: 15.35066484663198
Bronze Medals Model Evaluation:
MSE: 14.726264824957381
Total Medals Model Evaluation:
MSE: 123.04308202795725
Gold Medals Model Evaluation:
MSE: 16.378520776721903
Silver Medals Model Evaluation:
MSE: 13.313374606708491
Bronze Medals Model Evaluation:
MSE: 14.652005754387616
Total Medals Model Evaluation:
MSE: 92.45289568036877
Gold Medals Model Evaluation:
MSE: 17.45292206229233
Silver Medals Model Evaluation:
MSE: 9.54926623257859
Bronze Medals Model Evaluation:
MSE: 9.575333970581806
Total Medals Model Evaluation:
MSE: 141.5976571749477
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.763930751060396
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 124.00918192995411
Gold Medals Model Evaluation:
MSE: 15.70584489021724
Silver Medals Model Evaluation:
MSE: 13.685500024925961
Bronze Medals Model Evaluation:
MSE: 14.075050089775988
Total Medals Model Evaluation:
MSE: 135.07712626389417
Gold Medals Model Evaluation:
MSE: 16.407976076624227
Silver Medals Model Evaluation:
MSE: 14.712657467624638
Bronze Medals Model Evaluation:
MSE: 18.195535976693513
Total Medals Model Evaluation:
MSE: 141.4524764745244
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.06321729731559
Total Medals Model Evaluation:
MSE: 143.3969044824103
Gold Medals Model Evaluation:
MSE: 18.35809521683373
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 132.9917902552506
Gold Medals Model Evaluation:
MSE: 17.333133489644688
Silver Medals Model Evaluation:
MSE: 14.774083079468037
Bronze Medals Model Evaluation:
MSE: 14.888124326409718
Total Medals Model Evaluation:
MSE: 131.57558257428238
Gold Medals Model Evaluation:
MSE: 17.577953646470387
Silver Medals Model Evaluation:
MSE: 13.83418224110092
Bronze Medals Model Evaluation:
MSE: 15.704402378295871
Total Medals Model Evaluation:
MSE: 125.64458241245921
Gold Medals Model Evaluation:
MSE: 17.677077047051263
Silver Medals Model Evaluation:
MSE: 13.565503849149154
Bronze Medals Model Evaluation:
MSE: 14.639010014660908
Total Medals Model Evaluation:
MSE: 142.6711241751874
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.53910115819738
Total Medals Model Evaluation:
MSE: 119.74260543786875
Gold Medals Model Evaluation:
MSE: 16.40745144714485
Silver Medals Model Evaluation:
MSE: 13.848489533202711
Bronze Medals Model Evaluation:
MSE: 12.920595633059174
Total Medals Model Evaluation:
MSE: 119.64131817384899
Gold Medals Model Evaluation:
MSE: 15.789496425350672
Silver Medals Model Evaluation:
MSE: 13.436402389671295
Bronze Medals Model Evaluation:
MSE: 12.054728090609537
Total Medals Model Evaluation:
MSE: 132.08755741712528
Gold Medals Model Evaluation:
MSE: 17.16391235187512
Silver Medals Model Evaluation:
MSE: 14.09656418567718
Bronze Medals Model Evaluation:
MSE: 15.291661971328502
Total Medals Model Evaluation:
MSE: 141.42012674221036
Gold Medals Model Evaluation:
MSE: 18.33465279574127
Silver Medals Model Evaluation:
MSE: 14.846908790952323
Bronze Medals Model Evaluation:
MSE: 16.789748792221168
Total Medals Model Evaluation:
MSE: 71.46401099844464
Gold Medals Model Evaluation:
MSE: 10.874740656055133
Silver Medals Model Evaluation:
MSE: 8.503563416648833
Bronze Medals Model Evaluation:
MSE: 8.952931957009552
Total Medals Model Evaluation:
MSE: 430.3321074157528
Gold Medals Model Evaluation:
MSE: 51.211189027312564
Silver Medals Model Evaluation:
MSE: 60.169209903551945
Bronze Medals Model Evaluation:
MSE: 76.01822924563578
Total Medals Model Evaluation:
MSE: 141.9789980744976
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.847146113828398
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 128.99034889723183
Gold Medals Model Evaluation:
MSE: 16.59454281295756
Silver Medals Model Evaluation:
MSE: 13.569258233283135
Bronze Medals Model Evaluation:
MSE: 14.641360235746816
Total Medals Model Evaluation:
MSE: 958.9618946758767
Gold Medals Model Evaluation:
MSE: 89.13399482046448
Silver Medals Model Evaluation:
MSE: 101.97040236207555
Bronze Medals Model Evaluation:
MSE: 88.12731449605982
Total Medals Model Evaluation:
MSE: 137.77627507790044
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.505414889948891
Bronze Medals Model Evaluation:
MSE: 14.940825786098362
Total Medals Model Evaluation:
MSE: 423.5669933946924
Gold Medals Model Evaluation:
MSE: 36.31717644068732
Silver Medals Model Evaluation:
MSE: 47.29206765147535
Bronze Medals Model Evaluation:
MSE: 48.93329161520254
Total Medals Model Evaluation:
MSE: 145.86302352903726
Gold Medals Model Evaluation:
MSE: 19.99434790818509
Silver Medals Model Evaluation:
MSE: 23.392654973091872
Bronze Medals Model Evaluation:
MSE: 17.401896702261702
Total Medals Model Evaluation:
MSE: 139.87656568615063
Gold Medals Model Evaluation:
MSE: 18.441185924955366
Silver Medals Model Evaluation:
MSE: 13.53636457150377
Bronze Medals Model Evaluation:
MSE: 16.126925245552552
Total Medals Model Evaluation:
MSE: 139.00450093060985
Gold Medals Model Evaluation:
MSE: 18.257099882233568
Silver Medals Model Evaluation:
MSE: 15.39002164701618
Bronze Medals Model Evaluation:
MSE: 16.571470586552312
Total Medals Model Evaluation:
MSE: 142.2275439007511
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.306406148992405
Total Medals Model Evaluation:
MSE: 137.46119030179804
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.143672283592648
Bronze Medals Model Evaluation:
MSE: 16.943613958528637
Total Medals Model Evaluation:
MSE: 132.78970479872174
Gold Medals Model Evaluation:
MSE: 17.4729361979997
Silver Medals Model Evaluation:
MSE: 15.245944176253085
Bronze Medals Model Evaluation:
MSE: 15.606736971660961
Total Medals Model Evaluation:
MSE: 189.24244991334984
Gold Medals Model Evaluation:
MSE: 37.85571514365352
Silver Medals Model Evaluation:
MSE: 27.82685424008854
Bronze Medals Model Evaluation:
MSE: 31.511467693917236
Total Medals Model Evaluation:
MSE: 137.7564704547477
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.615002026414722
Bronze Medals Model Evaluation:
MSE: 15.55369268783078
Total Medals Model Evaluation:
MSE: 141.46316516955667
Gold Medals Model Evaluation:
MSE: 17.520532117597618
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 15.779644445974679
Total Medals Model Evaluation:
MSE: 137.7791441335767
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 13.761335055679432
Bronze Medals Model Evaluation:
MSE: 15.26846197606054
Total Medals Model Evaluation:
MSE: 128.71381913191783
Gold Medals Model Evaluation:
MSE: 17.69731813118513
Silver Medals Model Evaluation:
MSE: 14.284207697126444
Bronze Medals Model Evaluation:
MSE: 13.743768023631464
Total Medals Model Evaluation:
MSE: 128.79591029344485
Gold Medals Model Evaluation:
MSE: 16.960412414942144
Silver Medals Model Evaluation:
MSE: 14.181781246488878
Bronze Medals Model Evaluation:
MSE: 14.09178375897888
Total Medals Model Evaluation:
MSE: 114.8451674781899
Gold Medals Model Evaluation:
MSE: 15.416523229377445
Silver Medals Model Evaluation:
MSE: 13.84757605170232
Bronze Medals Model Evaluation:
MSE: 13.857348757217634
Total Medals Model Evaluation:
MSE: 142.97759343948675
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.562434910371756
Total Medals Model Evaluation:
MSE: 125.65896596947744
Gold Medals Model Evaluation:
MSE: 16.561858866459158
Silver Medals Model Evaluation:
MSE: 13.791116233875021
Bronze Medals Model Evaluation:
MSE: 12.911142548854563
Total Medals Model Evaluation:
MSE: 131.91750636022712
Gold Medals Model Evaluation:
MSE: 17.5655350180797
Silver Medals Model Evaluation:
MSE: 13.81521282450842
Bronze Medals Model Evaluation:
MSE: 15.049765848257437
Total Medals Model Evaluation:
MSE: 206.45664606820688
Gold Medals Model Evaluation:
MSE: 43.468497500318506
Silver Medals Model Evaluation:
MSE: 20.675656069336327
Bronze Medals Model Evaluation:
MSE: 17.542365157074435
Total Medals Model Evaluation:
MSE: 136.13675874993626
Gold Medals Model Evaluation:
MSE: 17.779087314064153
Silver Medals Model Evaluation:
MSE: 14.921817966987119
Bronze Medals Model Evaluation:
MSE: 15.62986508350761
Total Medals Model Evaluation:
MSE: 111.17327072317192
Gold Medals Model Evaluation:
MSE: 14.261646986460654
Silver Medals Model Evaluation:
MSE: 11.315058124927397
Bronze Medals Model Evaluation:
MSE: 12.197801233909257
Total Medals Model Evaluation:
MSE: 319.9670015264475
Gold Medals Model Evaluation:
MSE: 31.05901598394929
Silver Medals Model Evaluation:
MSE: 38.39943386640468
Bronze Medals Model Evaluation:
MSE: 24.50816027411338
Total Medals Model Evaluation:
MSE: 136.15506462077178
Gold Medals Model Evaluation:
MSE: 18.447981328716264
Silver Medals Model Evaluation:
MSE: 14.707436911961903
Bronze Medals Model Evaluation:
MSE: 14.775797220374905
Total Medals Model Evaluation:
MSE: 127.30748648909412
Gold Medals Model Evaluation:
MSE: 16.634659806400304
Silver Medals Model Evaluation:
MSE: 12.609374066776969
Bronze Medals Model Evaluation:
MSE: 13.842519328445977
Total Medals Model Evaluation:
MSE: 115.70549389757369
Gold Medals Model Evaluation:
MSE: 15.432247519733274
Silver Medals Model Evaluation:
MSE: 12.93039784822176
Bronze Medals Model Evaluation:
MSE: 12.110291854474921
Total Medals Model Evaluation:
MSE: 139.74747766272486
Gold Medals Model Evaluation:
MSE: 18.432234553194622
Silver Medals Model Evaluation:
MSE: 14.848137494719394
Bronze Medals Model Evaluation:
MSE: 16.22947823700332
Total Medals Model Evaluation:
MSE: 140.11930942429288
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 15.662211468322043
Total Medals Model Evaluation:
MSE: 133.10545942321878
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 13.96414535656642
Bronze Medals Model Evaluation:
MSE: 14.855834224010652
Total Medals Model Evaluation:
MSE: 127.56652924353895
Gold Medals Model Evaluation:
MSE: 17.353212941067035
Silver Medals Model Evaluation:
MSE: 13.276219113771015
Bronze Medals Model Evaluation:
MSE: 14.97416532796742
Total Medals Model Evaluation:
MSE: 137.71314003465486
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 13.785144539581065
Bronze Medals Model Evaluation:
MSE: 14.956013439102191
Total Medals Model Evaluation:
MSE: 125.57589470566808
Gold Medals Model Evaluation:
MSE: 16.80106889405876
Silver Medals Model Evaluation:
MSE: 14.256961497853823
Bronze Medals Model Evaluation:
MSE: 13.590768783485288
Total Medals Model Evaluation:
MSE: 137.07256891101002
Gold Medals Model Evaluation:
MSE: 16.767026971472696
Silver Medals Model Evaluation:
MSE: 15.144168640389212
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 141.87124104542065
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.243400642547297
Total Medals Model Evaluation:
MSE: 132.9885280255021
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.025048059925746
Bronze Medals Model Evaluation:
MSE: 15.550514312800422
Total Medals Model Evaluation:
MSE: 142.41286633228276
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.391406811866954
Total Medals Model Evaluation:
MSE: 122.88854761340191
Gold Medals Model Evaluation:
MSE: 17.41744942829359
Silver Medals Model Evaluation:
MSE: 13.266356384500956
Bronze Medals Model Evaluation:
MSE: 13.925095231808378
Total Medals Model Evaluation:
MSE: 130.3344856428949
Gold Medals Model Evaluation:
MSE: 23.178505781786185
Silver Medals Model Evaluation:
MSE: 13.800624435420994
Bronze Medals Model Evaluation:
MSE: 17.20539461309142
Total Medals Model Evaluation:
MSE: 135.3465064408034
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.570818820045854
Bronze Medals Model Evaluation:
MSE: 14.808219510499175
Total Medals Model Evaluation:
MSE: 133.5653302599893
Gold Medals Model Evaluation:
MSE: 18.243516810099045
Silver Medals Model Evaluation:
MSE: 14.158554731579681
Bronze Medals Model Evaluation:
MSE: 14.799591778455794
Total Medals Model Evaluation:
MSE: 141.9789980744976
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.847146113828398
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 128.53279094919372
Gold Medals Model Evaluation:
MSE: 15.163652603577788
Silver Medals Model Evaluation:
MSE: 14.394880057608226
Bronze Medals Model Evaluation:
MSE: 13.801221794303313
Total Medals Model Evaluation:
MSE: 139.33559570427354
Gold Medals Model Evaluation:
MSE: 17.19828224455516
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.79758977136095
Total Medals Model Evaluation:
MSE: 136.40619780497929
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 13.509131303570495
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 127.97074906745453
Gold Medals Model Evaluation:
MSE: 13.446127503491082
Silver Medals Model Evaluation:
MSE: 9.709605096279564
Bronze Medals Model Evaluation:
MSE: 22.473188101012962
Total Medals Model Evaluation:
MSE: 141.41526602534674
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.719530727107722
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 90.82187183131279
Gold Medals Model Evaluation:
MSE: 16.46292436843005
Silver Medals Model Evaluation:
MSE: 9.861979940395406
Bronze Medals Model Evaluation:
MSE: 10.557522512299439
Total Medals Model Evaluation:
MSE: 138.90460745989
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.334087824543742
Bronze Medals Model Evaluation:
MSE: 16.269595238379605
Total Medals Model Evaluation:
MSE: 130.24560627768508
Gold Medals Model Evaluation:
MSE: 17.046973306958115
Silver Medals Model Evaluation:
MSE: 13.388307855682035
Bronze Medals Model Evaluation:
MSE: 12.61663651919816
Total Medals Model Evaluation:
MSE: 117.16959512126158
Gold Medals Model Evaluation:
MSE: 15.025275128218055
Silver Medals Model Evaluation:
MSE: 13.17042773656496
Bronze Medals Model Evaluation:
MSE: 13.332845766228688
Total Medals Model Evaluation:
MSE: 142.02253023859032
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.879037674693903
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 113.12692967068391
Gold Medals Model Evaluation:
MSE: 12.567166176786662
Silver Medals Model Evaluation:
MSE: 12.097676294688442
Bronze Medals Model Evaluation:
MSE: 14.28169880610954
Total Medals Model Evaluation:
MSE: 137.73642807920788
Gold Medals Model Evaluation:
MSE: 17.805580306523346
Silver Medals Model Evaluation:
MSE: 14.831100015655679
Bronze Medals Model Evaluation:
MSE: 15.91288272227091
Total Medals Model Evaluation:
MSE: 137.56921310056828
Gold Medals Model Evaluation:
MSE: 17.115933522281484
Silver Medals Model Evaluation:
MSE: 15.028158419773177
Bronze Medals Model Evaluation:
MSE: 15.923797272210706
Total Medals Model Evaluation:
MSE: 142.67113750188773
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.087768574724542
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 137.6247990519643
Gold Medals Model Evaluation:
MSE: 18.015592930757705
Silver Medals Model Evaluation:
MSE: 13.891151909137237
Bronze Medals Model Evaluation:
MSE: 16.222980978212686
Total Medals Model Evaluation:
MSE: 130.93607685319475
Gold Medals Model Evaluation:
MSE: 17.55580040628031
Silver Medals Model Evaluation:
MSE: 14.047186837285457
Bronze Medals Model Evaluation:
MSE: 14.64044132805513
Total Medals Model Evaluation:
MSE: 141.09046314385375
Gold Medals Model Evaluation:
MSE: 15.615346401008328
Silver Medals Model Evaluation:
MSE: 9.488869177705215
Bronze Medals Model Evaluation:
MSE: 14.394994150607133
Total Medals Model Evaluation:
MSE: 128.74027775749815
Gold Medals Model Evaluation:
MSE: 16.882727234912707
Silver Medals Model Evaluation:
MSE: 13.574545565240095
Bronze Medals Model Evaluation:
MSE: 15.263664923091076
Total Medals Model Evaluation:
MSE: 136.06583345801198
Gold Medals Model Evaluation:
MSE: 18.282738631898457
Silver Medals Model Evaluation:
MSE: 15.022675106118193
Bronze Medals Model Evaluation:
MSE: 15.207178453684888
Total Medals Model Evaluation:
MSE: 137.2541636466537
Gold Medals Model Evaluation:
MSE: 18.2053941034054
Silver Medals Model Evaluation:
MSE: 14.758058418403055
Bronze Medals Model Evaluation:
MSE: 15.314030286556767
Total Medals Model Evaluation:
MSE: 319.3562992481888
Gold Medals Model Evaluation:
MSE: 32.45522085934934
Silver Medals Model Evaluation:
MSE: 44.730654201336975
Bronze Medals Model Evaluation:
MSE: 34.2966550913708
Total Medals Model Evaluation:
MSE: 143.3969044824103
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.724709920071003
Total Medals Model Evaluation:
MSE: 69.0968085735777
Gold Medals Model Evaluation:
MSE: 11.332462973290282
Silver Medals Model Evaluation:
MSE: 8.005806236692317
Bronze Medals Model Evaluation:
MSE: 6.9620993715241
Total Medals Model Evaluation:
MSE: 731.6196669968692
Gold Medals Model Evaluation:
MSE: 155.5471407104923
Silver Medals Model Evaluation:
MSE: 62.76565025740928
Bronze Medals Model Evaluation:
MSE: 34.14865917254159
Total Medals Model Evaluation:
MSE: 142.85282353556897
Gold Medals Model Evaluation:
MSE: 18.35809521683373
Silver Medals Model Evaluation:
MSE: 15.297862980408816
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 141.97211501849736
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.868688356632255
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 140.1860723417631
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.89386352183329
Bronze Medals Model Evaluation:
MSE: 16.3834643829581
Total Medals Model Evaluation:
MSE: 139.81409086366125
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.990330475436913
Bronze Medals Model Evaluation:
MSE: 15.767712838466531
Total Medals Model Evaluation:
MSE: 141.41526602534674
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.719530727107722
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 115.50343250893141
Gold Medals Model Evaluation:
MSE: 16.76679836055545
Silver Medals Model Evaluation:
MSE: 12.520437626804206
Bronze Medals Model Evaluation:
MSE: 13.279401321327365
Total Medals Model Evaluation:
MSE: 139.60382040217826
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.212751059806186
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 137.50041052809894
Gold Medals Model Evaluation:
MSE: 16.404693533998483
Silver Medals Model Evaluation:
MSE: 14.816481700720088
Bronze Medals Model Evaluation:
MSE: 14.844592006576514
Total Medals Model Evaluation:
MSE: 126.16630244990345
Gold Medals Model Evaluation:
MSE: 15.071809809910627
Silver Medals Model Evaluation:
MSE: 13.40853226322626
Bronze Medals Model Evaluation:
MSE: 12.597443131742804
Total Medals Model Evaluation:
MSE: 127.25009954091041
Gold Medals Model Evaluation:
MSE: 16.926480710184762
Silver Medals Model Evaluation:
MSE: 13.85025155682014
Bronze Medals Model Evaluation:
MSE: 15.943679690749073
Total Medals Model Evaluation:
MSE: 122.22429946498771
Gold Medals Model Evaluation:
MSE: 16.772517866978095
Silver Medals Model Evaluation:
MSE: 11.583161634916555
Bronze Medals Model Evaluation:
MSE: 13.999412456879316
Total Medals Model Evaluation:
MSE: 251.61842026089872
Gold Medals Model Evaluation:
MSE: 33.140948130894614
Silver Medals Model Evaluation:
MSE: 19.51450542095045
Bronze Medals Model Evaluation:
MSE: 26.495273911833902
Total Medals Model Evaluation:
MSE: 105.98040261668906
Gold Medals Model Evaluation:
MSE: 15.69860768926409
Silver Medals Model Evaluation:
MSE: 15.896625274102412
Bronze Medals Model Evaluation:
MSE: 14.196455796077425
Total Medals Model Evaluation:
MSE: 141.82337932321212
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.772864172316424
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 141.97211501849736
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.868688356632255
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 138.76663959741063
Gold Medals Model Evaluation:
MSE: 18.348737894531723
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 15.32975484106139
Total Medals Model Evaluation:
MSE: 97.86561132643006
Gold Medals Model Evaluation:
MSE: 9.939944801859536
Silver Medals Model Evaluation:
MSE: 14.530194606984049
Bronze Medals Model Evaluation:
MSE: 11.830940058907796
Total Medals Model Evaluation:
MSE: 92.3029029187137
Gold Medals Model Evaluation:
MSE: 16.731164303443318
Silver Medals Model Evaluation:
MSE: 10.859344784883668
Bronze Medals Model Evaluation:
MSE: 9.421127814825896
Total Medals Model Evaluation:
MSE: 138.59047770663238
Gold Medals Model Evaluation:
MSE: 17.75290432646527
Silver Medals Model Evaluation:
MSE: 15.428913291547145
Bronze Medals Model Evaluation:
MSE: 15.990374443350733
Total Medals Model Evaluation:
MSE: 144.00537634408602
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 139.89583852281243
Gold Medals Model Evaluation:
MSE: 18.49097762254012
Silver Medals Model Evaluation:
MSE: 15.364905985556241
Bronze Medals Model Evaluation:
MSE: 15.351029718397214
Total Medals Model Evaluation:
MSE: 138.15749736287572
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 13.867874875710406
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 124.52643597291664
Gold Medals Model Evaluation:
MSE: 16.54440089048447
Silver Medals Model Evaluation:
MSE: 13.363132120760671
Bronze Medals Model Evaluation:
MSE: 14.387371590097464
Total Medals Model Evaluation:
MSE: 142.41286633228276
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.391406811866954
Total Medals Model Evaluation:
MSE: 141.23447219747518
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.637407466189542
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 133.09967521980215
Gold Medals Model Evaluation:
MSE: 18.044336810714906
Silver Medals Model Evaluation:
MSE: 14.63179011803488
Bronze Medals Model Evaluation:
MSE: 14.792626154088062
Total Medals Model Evaluation:
MSE: 133.92583877046084
Gold Medals Model Evaluation:
MSE: 17.53268434088007
Silver Medals Model Evaluation:
MSE: 14.570375991830685
Bronze Medals Model Evaluation:
MSE: 12.342067246971313
Total Medals Model Evaluation:
MSE: 118.09401599766086
Gold Medals Model Evaluation:
MSE: 15.895064846442166
Silver Medals Model Evaluation:
MSE: 13.026615279307633
Bronze Medals Model Evaluation:
MSE: 13.59106185654135
Total Medals Model Evaluation:
MSE: 142.02253023859032
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.879037674693903
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 136.1892923916188
Gold Medals Model Evaluation:
MSE: 17.199064555728967
Silver Medals Model Evaluation:
MSE: 14.479878408930748
Bronze Medals Model Evaluation:
MSE: 16.335528680973404
Total Medals Model Evaluation:
MSE: 147.09534075675091
Gold Medals Model Evaluation:
MSE: 17.525681307294043
Silver Medals Model Evaluation:
MSE: 11.920742772536746
Bronze Medals Model Evaluation:
MSE: 21.738538680584604
Total Medals Model Evaluation:
MSE: 801.8796592665005
Gold Medals Model Evaluation:
MSE: 127.08414639875762
Silver Medals Model Evaluation:
MSE: 92.8079718222651
Bronze Medals Model Evaluation:
MSE: 54.35878860000859
Total Medals Model Evaluation:
MSE: 139.97747351836793
Gold Medals Model Evaluation:
MSE: 18.31775223173615
Silver Medals Model Evaluation:
MSE: 15.480645161290322
Bronze Medals Model Evaluation:
MSE: 16.10785772122929
Total Medals Model Evaluation:
MSE: 7955.440914422284
Gold Medals Model Evaluation:
MSE: 1287.7319429982033
Silver Medals Model Evaluation:
MSE: 886.8534870824524
Bronze Medals Model Evaluation:
MSE: 502.76065810972136
Total Medals Model Evaluation:
MSE: 136.6027273902471
Gold Medals Model Evaluation:
MSE: 17.93912512270018
Silver Medals Model Evaluation:
MSE: 14.284246468040052
Bronze Medals Model Evaluation:
MSE: 15.606827977360092
Total Medals Model Evaluation:
MSE: 118.05266389190098
Gold Medals Model Evaluation:
MSE: 17.147729741230755
Silver Medals Model Evaluation:
MSE: 14.076711138301276
Bronze Medals Model Evaluation:
MSE: 13.454165858708564
Total Medals Model Evaluation:
MSE: 130.08125955237986
Gold Medals Model Evaluation:
MSE: 18.012003816764853
Silver Medals Model Evaluation:
MSE: 12.81432007096309
Bronze Medals Model Evaluation:
MSE: 14.951866215159672
Total Medals Model Evaluation:
MSE: 138.9081210348589
Gold Medals Model Evaluation:
MSE: 17.97066037439278
Silver Medals Model Evaluation:
MSE: 14.325087813911944
Bronze Medals Model Evaluation:
MSE: 16.856653003907994
Total Medals Model Evaluation:
MSE: 141.41526602534674
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.719530727107722
Bronze Medals Model Evaluation:
MSE: 16.93763440860215
Total Medals Model Evaluation:
MSE: 138.59047770663238
Gold Medals Model Evaluation:
MSE: 18.508602150537634
Silver Medals Model Evaluation:
MSE: 14.379276547459726
Bronze Medals Model Evaluation:
MSE: 15.834178407042506
Total Medals Model Evaluation:
MSE: 128.59097654913361
Gold Medals Model Evaluation:
MSE: 16.939784606300343
Silver Medals Model Evaluation:
MSE: 13.285004550045176
Bronze Medals Model Evaluation:
MSE: 16.012281431777485
               NOC  Total\_Predicted  Gold\_Predicted  Silver\_Predicted  \textbackslash{}
0      Afghanistan                1               0                 0
1          Albania                2               0                 0
2          Algeria                4               2                 0
3        Argentina                3               1                 1
4          Armenia                4               0                 3
..             {\ldots}              {\ldots}             {\ldots}               {\ldots}
150      Venezuela                3               0                 2
151        Vietnam                1               0                 1
152  VirginIslands                0               0                 0
153         Zambia                1               0                 0
154       Zimbabwe                3               1                 2

     Bronze\_Predicted
0                   1
1                   2
2                   2
3                   1
4                   1
..                {\ldots}
150                 0
151                 0
152                 0
153                 1
154                 0

[155 rows x 5 columns]
    \end{Verbatim}

    \subsubsection{非超参数优化模型}\label{ux975eux8d85ux53c2ux6570ux4f18ux5316ux6a21ux578b}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{71}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{xgboost}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{XGBRegressor}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{,} \PY{n}{GridSearchCV}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LabelEncoder}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 将国家代码转换为数值标签}
\PY{n}{label\PYZus{}encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 处理缺失值}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建特征：前一届奥运会的奖牌总数、金牌数、银牌数、铜牌数}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 选择特征和目标变量}
\PY{n}{features} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{target\PYZus{}total} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}gold} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}silver} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}bronze} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 划分训练集和测试集}
\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}total}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}gold}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}silver}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}bronze}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义XGBoost模型}
\PY{n}{model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 超参数优化}
\PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{150}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 使用GridSearchCV进行超参数优化}
\PY{n}{grid\PYZus{}search\PYZus{}total} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}total}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}gold}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}silver}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}bronze}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 训练模型}
\PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 获取最佳模型}
\PY{n}{best\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}

\PY{c+c1}{\PYZsh{} 评估模型}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{mse} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE: }\PY{l+s+si}{\PYZob{}}\PY{n}{mse}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{n}{y\PYZus{}pred}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gold Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Silver Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bronze Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 为每个国家单独训练模型}
\PY{n}{country\PYZus{}models} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 确保每个国家至少有两条记录}
        \PY{n}{country\PYZus{}features} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{n}{country\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        
        \PY{n}{country\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}total}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}gold}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}silver}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}bronze}\PY{p}{)}
        
        \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}total}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}gold}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}silver}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}bronze}
        \PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 预测2028年奥运会的奖牌数}
\PY{n}{next\PYZus{}year} \PY{o}{=} \PY{l+m+mi}{2028}
\PY{n}{predictions} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{prev\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{next\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{next\PYZus{}year}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{,}  \PY{c+c1}{\PYZsh{} 添加NOC列}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}total}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}gold}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}silver}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}bronze}\PY{p}{]}
        \PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用单独模型预测}
        \PY{n}{total\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用整体模型预测}
        \PY{n}{total\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 根据数据量分配权重}
        \PY{n}{data\PYZus{}count} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)}
        \PY{n}{weight} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{data\PYZus{}count} \PY{o}{/} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 数据量越多，权重越高，但不超过1}
        \PY{n}{total\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{total\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{total\PYZus{}pred\PYZus{}global}
        \PY{n}{gold\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{gold\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{gold\PYZus{}pred\PYZus{}global}
        \PY{n}{silver\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{silver\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{silver\PYZus{}pred\PYZus{}global}
        \PY{n}{bronze\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{bronze\PYZus{}pred} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{bronze\PYZus{}pred\PYZus{}global}
        
        \PY{c+c1}{\PYZsh{} 对预测结果取整}
        \PY{n}{total\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}combined} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}pred\PYZus{}combined}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{n}{predictions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{total\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{gold\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{silver\PYZus{}pred\PYZus{}combined}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{bronze\PYZus{}pred\PYZus{}combined}
        \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将预测结果转换为DataFrame}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{predictions}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将NOC标签转换回国家代码}
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存预测结果到CSV文件}
\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}2.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Total Medals Model Evaluation:
MSE: 14.183948320207696
Gold Medals Model Evaluation:
MSE: 2.9414593946059715
Silver Medals Model Evaluation:
MSE: 1.8287626291987034
Bronze Medals Model Evaluation:
MSE: 2.185780634244944
               NOC  Total\_Predicted  Gold\_Predicted  Silver\_Predicted  \textbackslash{}
0      Afghanistan                1               0                 0
1          Albania                2               0                 0
2          Algeria                5               2                 0
3        Argentina                3               1                 1
4          Armenia                4               0                 3
..             {\ldots}              {\ldots}             {\ldots}               {\ldots}
150      Venezuela                3               1                 2
151        Vietnam                1               0                 1
152  VirginIslands                0               0                 0
153         Zambia                1               0                 0
154       Zimbabwe                3               1                 2

     Bronze\_Predicted
0                   1
1                   2
2                   2
3                   1
4                   1
..                {\ldots}
150                 0
151                 0
152                 0
153                 1
154                 0

[155 rows x 5 columns]
    \end{Verbatim}

    \subsubsection{评估预测区间}\label{ux8bc4ux4f30ux9884ux6d4bux533aux95f4}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{math}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}2.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 将国家代码转换为数值标签}
\PY{n}{label\PYZus{}encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)} 
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 处理缺失值}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建特征：前一届奥运会的奖牌总数、金牌数、银牌数、铜牌数}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{k}{def}\PY{+w}{ }\PY{n+nf}{evaluate\PYZus{}model\PYZus{}2}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{mse} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE: }\PY{l+s+si}{\PYZob{}}\PY{n}{mse}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{n}{mse}

\PY{c+c1}{\PYZsh{} 计算预测区间}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{prediction\PYZus{}interval}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{confidence}\PY{o}{=}\PY{l+m+mf}{0.95}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} 评估区间}
    \PY{n}{interval\PYZus{}get} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{evaluate\PYZus{}model\PYZus{}2}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{p}{)}
    \PY{n}{preds} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 进行10次预测以估计不确定性}
        \PY{n}{preds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{)}
    \PY{n}{preds} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{preds}\PY{p}{)}
    \PY{n}{lower} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{preds}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{confidence}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2} \PY{o}{*} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb}{round}\PY{p}{(}\PY{n}{interval\PYZus{}get}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{upper} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{preds}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{confidence}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2} \PY{o}{*} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{+} \PY{n+nb}{round}\PY{p}{(}\PY{n}{interval\PYZus{}get}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{k}{return} \PY{n}{lower}\PY{p}{,} \PY{n}{upper}

\PY{c+c1}{\PYZsh{} 计算每个国家的预测区间}
\PY{n}{prediction\PYZus{}intervals} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{country}\PY{p}{,} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{prev\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{next\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{next\PYZus{}year}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}total}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}gold}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}silver}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}bronze}\PY{p}{]}
        \PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{n}{total\PYZus{}lower}\PY{p}{,} \PY{n}{total\PYZus{}upper} \PY{o}{=} \PY{n}{prediction\PYZus{}interval}\PY{p}{(}\PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{next\PYZus{}data}\PY{p}{,} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{2024}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
        \PY{n}{gold\PYZus{}lower}\PY{p}{,} \PY{n}{gold\PYZus{}upper} \PY{o}{=} \PY{n}{prediction\PYZus{}interval}\PY{p}{(}\PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{next\PYZus{}data}\PY{p}{,} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{2024}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
        \PY{n}{silver\PYZus{}lower}\PY{p}{,} \PY{n}{silver\PYZus{}upper} \PY{o}{=} \PY{n}{prediction\PYZus{}interval}\PY{p}{(}\PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{next\PYZus{}data}\PY{p}{,} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{2024}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
        \PY{n}{bronze\PYZus{}lower}\PY{p}{,} \PY{n}{bronze\PYZus{}upper} \PY{o}{=} \PY{n}{prediction\PYZus{}interval}\PY{p}{(}\PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{next\PYZus{}data}\PY{p}{,} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{2024}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
        
        \PY{n}{prediction\PYZus{}intervals}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}lower}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}upper}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}lower}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}upper}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}lower}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}upper}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}lower}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}upper}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将预测区间转换为DataFrame}
\PY{n}{prediction\PYZus{}intervals\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{prediction\PYZus{}intervals}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将NOC标签转换回国家代码}
\PY{n}{prediction\PYZus{}intervals\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{prediction\PYZus{}intervals\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测区间}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{prediction\PYZus{}intervals\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存预测区间到CSV文件}
\PY{n}{prediction\PYZus{}intervals\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}intervals.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
     NOC  Total\_Predicted  Gold\_Predicted  Silver\_Predicted  Bronze\_Predicted  \textbackslash{}
0      0                1               0                 0                 1
1      1                2               0                 0                 2
2      2                5               2                 0                 2
3      3                3               1                 1                 1
4      4                4               0                 3                 1
..   {\ldots}              {\ldots}             {\ldots}               {\ldots}               {\ldots}
150  150                3               1                 2                 0
151  151                1               0                 1                 0
152  152                0               0                 0                 0
153  153                1               0                 0                 1
154  154                3               1                 2                 0

              NOC2
0      Afghanistan
1          Albania
2          Algeria
3        Argentina
4          Armenia
..             {\ldots}
150      Venezuela
151        Vietnam
152  VirginIslands
153         Zambia
154       Zimbabwe

[155 rows x 6 columns]
0 Afghanistan
MSE: 1.6973353922367096e-07
MSE: 0.0
MSE: 0.0
MSE: 1.6973353922367096e-07
1 Albania
MSE: 1.5524549326073611e-06
MSE: 0.0
MSE: 0.0
MSE: 1.5524549326073611e-06
2 Algeria
MSE: 3.994724107171578
MSE: 0.0715187132484516
MSE: 6.735792893548496e-07
MSE: 0.40100133269567095
3 Argentina
MSE: 2.3470784071832895e-07
MSE: 3.494688058935935e-07
MSE: 4.82183182271001e-09
MSE: 1.0942446948547513e-08
4 Armenia
MSE: 1.7953652786673047e-08
MSE: 0.022775736567688165
MSE: 1.1654483387246728e-06
MSE: 0.000602870343314521
5 Australasia
MSE: 7.366907084360719e-09
MSE: 2.8141045049778768e-09
MSE: 0.0
MSE: 3.5811922316497657e-09
6 Australia
MSE: 46.04812975054665
MSE: 18.760339548826778
MSE: 14.428052094081067
MSE: 2.297645300950535
7 Austria
MSE: 3.2837787522751114
MSE: 0.929088444383197
MSE: 0.3103930830840831
MSE: 0.12714879985674088
8 Azerbaijan
MSE: 0.9369287917252223
MSE: 5.139809786669503e-07
MSE: 0.01512698294305892
MSE: 3.4371402080068947e-07
9 Bahamas
MSE: 2.9368317200351157e-07
MSE: 4.619677440587111e-08
MSE: 2.775757794742491e-08
MSE: 4.4608173054226145e-07
10 Bahrain
MSE: 1.4410503013095877e-06
MSE: 1.3981571242993596e-06
MSE: 2.537326828644382e-07
MSE: 1.4199488305166597e-06
11 Barbados
MSE: 1.140026007704961e-08
MSE: 0.0
MSE: 0.0
MSE: 1.140026007704961e-08
12 Belarus
MSE: 0.04860342527626926
MSE: 5.0977689625142375e-08
MSE: 0.10681934870467558
MSE: 3.903685922068689e-06
13 Belgium
MSE: 1.1185702533111908e-06
MSE: 0.10785510490313754
MSE: 2.5321249417231684e-06
MSE: 8.881784197001252e-08
14 Bermuda
MSE: 1.1742159244931827e-08
MSE: 1.6973353922367096e-07
MSE: 0.0
MSE: 2.3612407219856805e-08
15 Botswana
MSE: 1.3981571242993596e-06
MSE: 1.4199488305166597e-06
MSE: 0.06726882339650331
MSE: 9.92802048623378e-08
16 Brazil
MSE: 2.201559254899621e-07
MSE: 0.019516072094120318
MSE: 1.5123171124287182e-06
MSE: 3.873096941505537
17 BritishWestIndies
MSE: 2.3428810891346075e-08
MSE: 0.0
MSE: 0.0
MSE: 2.3428810891346075e-08
18 Bulgaria
MSE: 3.1766921892995015e-07
MSE: 0.011571393059114143
MSE: 0.42826602829359217
MSE: 0.0004790748798768618
19 BurkinaFaso
MSE: 4.778883209155538e-07
MSE: 0.0
MSE: 0.0
MSE: 4.778883209155538e-07
20 Burundi
MSE: 7.42305452661185e-08
MSE: 1.0778264337465494e-08
MSE: 2.1742369327171218e-07
MSE: 0.0
21 CaboVerde
MSE: 1.4199488305166597e-06
MSE: 0.0
MSE: 0.0
MSE: 1.4199488305166597e-06
22 Cameroon
MSE: 3.263864201130673e-08
MSE: 4.982917154450206e-07
MSE: 3.155964636928306e-08
MSE: 2.0903196290074218e-07
23 Canada
MSE: 1.63796721608378e-06
MSE: 1.4971092241466977e-06
MSE: 1.342618816124741e-08
MSE: 0.008354335444892058
24 Ceylon
MSE: 7.160666008459318e-09
MSE: 0.0
MSE: 7.160666008459318e-09
MSE: 0.0
25 Chile
MSE: 3.476111487543676e-08
MSE: 7.718895744801557e-09
MSE: 1.955996253855119e-09
MSE: 1.9367148421502254e-08
26 China
MSE: 1.6994433920481242
MSE: 3.6888543146196753
MSE: 0.049751780348742614
MSE: 0.22513277226607897
27 ChineseTaipei
MSE: 4.584762791637331e-07
MSE: 2.8574106636369834e-08
MSE: 9.210824938766463e-05
MSE: 1.4479246601695195e-07
28 Colombia
MSE: 4.800773467650288e-08
MSE: 7.667576085625353e-08
MSE: 1.885928213596344e-08
MSE: 1.248465650860453e-07
29 CostaRica
MSE: 3.2878375577638508e-09
MSE: 1.1996345016534961e-08
MSE: 1.654898907929553e-08
MSE: 2.1325163857000007e-08
30 Croatia
MSE: 2.7412261260906234e-07
MSE: 1.1951328815484885e-09
MSE: 2.786348431982333e-07
MSE: 0.09114096443249764
31 Cuba
MSE: 33.48610947668567
MSE: 1.2728315964550916
MSE: 0.948688959761057
MSE: 2.3940999722990455
32 Cyprus
MSE: 2.1742369327171218e-07
MSE: 0.0
MSE: 2.1742369327171218e-07
MSE: 0.0
33 CzechRepublic
MSE: 0.84680817145113
MSE: 1.0291515195604006e-06
MSE: 0.9990270121516573
MSE: 3.725290298461914e-09
34 Denmark
MSE: 0.03616618936939631
MSE: 9.044993589668593e-07
MSE: 0.1823740395662412
MSE: 1.0471276254975237e-06
35 Djibouti
MSE: 4.99626951493399e-10
MSE: 0.0
MSE: 0.0
MSE: 4.99626951493399e-10
36 Dominica
MSE: 1.4199488305166597e-06
MSE: 1.4199488305166597e-06
MSE: 0.0
MSE: 0.0
37 DominicanRepublic
MSE: 2.525930540286936e-07
MSE: 1.868126137338777e-06
MSE: 9.782178919332541e-08
MSE: 6.22405934791459e-07
38 Ecuador
MSE: 1.5181867638602853e-06
MSE: 6.74118041388283e-08
MSE: 1.7011171991043739e-06
MSE: 1.5524549326073611e-06
39 Egypt
MSE: 0.23856807980359918
MSE: 3.078030772485363e-07
MSE: 1.7557830744863168e-09
MSE: 4.140958503623779
40 Eritrea
MSE: 1.2923835163312744e-08
MSE: 0.0
MSE: 0.0
MSE: 1.2923835163312744e-08
41 Estonia
MSE: 2.1151436158106662e-10
MSE: 6.444296118957027e-08
MSE: 1.6270200604035775e-08
MSE: 3.412026217120001e-09
42 Ethiopia
MSE: 0.010629131050393426
MSE: 1.8673951274195133e-07
MSE: 0.019763054388022283
MSE: 1.2788976758932105e-06
43 FRYugoslavia
MSE: 5.835327101522125e-07
MSE: 7.42305452661185e-08
MSE: 7.42305452661185e-08
MSE: 1.0830504493242188e-08
44 Fiji
MSE: 6.195568857947364e-08
MSE: 3.211040390258338e-07
MSE: 1.4199488305166597e-06
MSE: 9.92802048623378e-08
45 Finland
MSE: 1.1690545420606213e-06
MSE: 2.1794434937132136e-08
MSE: 1.4613750559701322e-06
MSE: 6.722712555529142e-07
46 France
MSE: 43.71525864351133
MSE: 7.979276914310503
MSE: 12.340475586766843
MSE: 53.4596161448726
47 Gabon
MSE: 2.3095451991457522e-08
MSE: 0.0
MSE: 2.3095451991457522e-08
MSE: 0.0
48 Georgia
MSE: 0.7632527873668096
MSE: 0.16041672148645603
MSE: 2.521139776945347e-07
MSE: 8.145667749204222e-07
49 Germany
MSE: 6.055925041437149e-07
MSE: 0.06465836433926597
MSE: 0.00010631933400873095
MSE: 1.0608346201479435e-08
50 Ghana
MSE: 2.5669578462839127e-08
MSE: 0.0
MSE: 2.263556034862694e-08
MSE: 2.873554194593453e-08
51 GreatBritain
MSE: 2.852175384759903e-09
MSE: 1.6575540939811617e-08
MSE: 0.00024034082889556885
MSE: 34.540550915757194
52 Greece
MSE: 3.0976461244392794
MSE: 1.2118888018651433
MSE: 0.9956312315707692
MSE: 5.115907697472721e-07
53 Grenada
MSE: 1.3981571242993596e-06
MSE: 6.5833540192780865e-09
MSE: 1.6884047836144305e-09
MSE: 1.4026714012516095e-06
54 Guatemala
MSE: 1.3981571242993596e-06
MSE: 4.778883209155538e-07
MSE: 6.5833540192780865e-09
MSE: 4.778883209155538e-07
55 Guyana
MSE: 1.6995968167330504e-08
MSE: 0.0
MSE: 0.0
MSE: 1.6995968167330504e-08
56 Haiti
MSE: 5.802590408165997e-09
MSE: 0.0
MSE: 1.1631658389687339e-08
MSE: 8.517478996543298e-09
57 HongKong
MSE: 1.248465650860453e-07
MSE: 1.8416621969663538e-06
MSE: 1.2191963105777634e-07
MSE: 1.2249893188709393e-07
58 Hungary
MSE: 0.002195656594267348
MSE: 0.0002019169187406078
MSE: 1.1612176542187171
MSE: 0.006406245419384504
59 Iceland
MSE: 2.324669878817076e-08
MSE: 0.0
MSE: 0.002013544599727135
MSE: 1.4244981230149278e-06
60 IndependentOlympicAthletes
MSE: 1.1061871418860392e-09
MSE: 3.211040390258338e-07
MSE: 0.0
MSE: 3.211040390258338e-07
61 IndependentOlympicParticipants
MSE: 3.8314794892357895e-08
MSE: 0.0
MSE: 1.2548357216595072e-08
MSE: 1.0830504493242188e-08
62 India
MSE: 0.06979242902184524
MSE: 0.7265408555982198
MSE: 0.9983279547677739
MSE: 4.9885456974152476e-06
63 Indonesia
MSE: 1.8737522608134896
MSE: 1.6257845345535316e-06
MSE: 1.3687797402614174e-06
MSE: 2.4663728481755243e-07
64 Iran
MSE: 1.642853021621704e-06
MSE: 5.83309542889765e-08
MSE: 7.531583619324067
MSE: 2.180833917009295e-06
65 Iraq
MSE: 2.7549018638868555e-08
MSE: 0.0
MSE: 0.0
MSE: 2.7549018638868555e-08
66 Ireland
MSE: 1.4142724467092194e-06
MSE: 1.8448991454533825e-06
MSE: 0.46593481471610687
MSE: 0.7807063998482136
67 Israel
MSE: 1.7584991383046145e-06
MSE: 1.3219647598816664e-07
MSE: 1.8261644072481431e-06
MSE: 2.7850900607973017e-07
68 Italy
MSE: 0.00036612991243600845
MSE: 1.4288358099438483
MSE: 0.564170645521699
MSE: 1.7591466999292606
69 IvoryCoast
MSE: 2.6284396881237626e-08
MSE: 2.3095451991457522e-08
MSE: 1.8298635804604773e-08
MSE: 9.313225746154785e-08
70 Jamaica
MSE: 3.1977305135480947
MSE: 0.013250568242767713
MSE: 0.0024697603890331266
MSE: 0.3690294030780592
71 Japan
MSE: 3.2145180739462376e-08
MSE: 5.820766091346741e-11
MSE: 1.2450072972569615e-06
MSE: 0.000157535324433411
72 Jordan
MSE: 3.32009939540967e-08
MSE: 5.387291710150455e-09
MSE: 4.778883209155538e-07
MSE: 1.6884047836144305e-09
73 Kazakhstan
MSE: 3.9617589209228754e-07
MSE: 1.0344371048631729e-07
MSE: 1.3376143215282355e-07
MSE: 1.7768252291716635e-07
74 Kenya
MSE: 4.193143468000926e-07
MSE: 1.161333784693852e-08
MSE: 1.8744076498933282e-05
MSE: 1.8814792641026088
75 Kosovo
MSE: 4.5204160414868966e-07
MSE: 1.4409998954043146e-07
MSE: 1.4199488305166597e-06
MSE: 1.4199488305166597e-06
76 Kuwait
MSE: 1.0754776269550348e-07
MSE: 0.0
MSE: 0.0
MSE: 1.0754776269550348e-07
77 Kyrgyzstan
MSE: 0.08774251273848677
MSE: 0.0
MSE: 3.089947000489701e-07
MSE: 1.5193620583886513e-06
78 Latvia
MSE: 6.0040861171728466e-09
MSE: 1.0754776269550348e-07
MSE: 5.725222185767824e-11
MSE: 1.3648104868480004e-10
79 Lebanon
MSE: 2.1325163857000007e-08
MSE: 0.0
MSE: 5.551115123125783e-09
MSE: 3.915943125321064e-10
80 Lithuania
MSE: 0.6522478321587641
MSE: 7.01580543894945e-07
MSE: 0.9995318007261176
MSE: 1.0194995070378354e-08
81 Luxembourg
MSE: 1.6816557035781443e-09
MSE: 6.814904196517091e-09
MSE: 3.3506523167585813e-09
MSE: 0.0
82 Macedonia
MSE: 1.140026007704961e-08
MSE: 0.0
MSE: 0.0
MSE: 1.140026007704961e-08
83 Malaysia
MSE: 8.543997864762787e-08
MSE: 0.0
MSE: 1.4577337912290291e-06
MSE: 1.5757123605908419e-06
84 Mauritius
MSE: 1.074163096010802e-08
MSE: 0.0
MSE: 0.0
MSE: 1.074163096010802e-08
85 Mexico
MSE: 0.9750407944522976
MSE: 0.00123627023016383
MSE: 0.9532222128905801
MSE: 3.5144368818055796
86 Mixedteam
MSE: 9.094947017729282e-13
MSE: 4.330104275140911e-09
MSE: 1.035971308738226e-09
MSE: 4.8466972657479346e-09
87 Moldova
MSE: 0.12468672506435041
MSE: 0.0
MSE: 1.4780625043897544e-06
MSE: 1.81073210114846e-06
88 Mongolia
MSE: 0.5925653473187964
MSE: 6.8889623910832355e-09
MSE: 0.8167207442879034
MSE: 3.9594106877861037
89 Montenegro
MSE: 2.3095451991457522e-08
MSE: 0.0
MSE: 2.3095451991457522e-08
MSE: 0.0
90 Morocco
MSE: 0.0621849701985866
MSE: 4.6511901530266186e-07
MSE: 6.6136397777894295e-09
MSE: 0.06726647361860216
91 Mozambique
MSE: 7.42305452661185e-08
MSE: 6.5513532170963446e-09
MSE: 0.0
MSE: 1.1996345016534961e-08
92 Namibia
MSE: 2.0497751052062085e-08
MSE: 0.0
MSE: 2.0497751052062085e-08
MSE: 0.0
93 Netherlands
MSE: 4.895264282822609e-08
MSE: 1.682201400399208e-06
MSE: 3.4904610402008984e-07
MSE: 1.101434463635087e-07
94 NetherlandsAntilles
MSE: 4.99626951493399e-10
MSE: 0.0
MSE: 4.99626951493399e-10
MSE: 0.0
95 NewZealand
MSE: 5.392394086811692e-07
MSE: 1.813299604691565e-06
MSE: 1.4324768926599063e-06
MSE: 1.1054964943468804e-08
96 Niger
MSE: 6.407848474054845e-09
MSE: 0.0
MSE: 9.313225746154785e-08
MSE: 2.1719322495902997e-08
97 Nigeria
MSE: 2.1082144030515337e-08
MSE: 2.5066654497944264e-09
MSE: 5.0816325369851256e-08
MSE: 6.369734961708673e-09
98 NorthKorea
MSE: 5.8215846365783364e-08
MSE: 1.792197035308668e-06
MSE: 3.387004312571662e-07
MSE: 1.0614653211096083
99 NorthMacedonia
MSE: 4.778883209155538e-07
MSE: 0.0
MSE: 4.778883209155538e-07
MSE: 0.0
100 Norway
MSE: 0.09249974467115862
MSE: 0.06336245393163153
MSE: 0.8465350429990082
MSE: 2.7309997733482305e-05
101 Pakistan
MSE: 2.063451631784119e-08
MSE: 1.4284850990975428e-07
MSE: 9.562590587676924e-09
MSE: 2.0079145783913323e-09
102 Panama
MSE: 2.0259506072761724e-08
MSE: 1.46794109540162e-09
MSE: 4.778883209155538e-07
MSE: 8.960664046499676e-10
103 Paraguay
MSE: 1.2923835163312744e-08
MSE: 0.0
MSE: 1.2923835163312744e-08
MSE: 0.0
104 Peru
MSE: 1.0424972884948147e-08
MSE: 5.429920696925306e-09
MSE: 2.5110489548319094e-09
MSE: 2.537326828644382e-07
105 Philippines
MSE: 4.760770480061183e-07
MSE: 1.3981571242993596e-06
MSE: 0.22906018066709866
MSE: 1.762611660183211e-06
106 Poland
MSE: 1.8835820108652115
MSE: 1.4319062415779626e-06
MSE: 0.011657366299914429
MSE: 0.06389915492400178
107 Portugal
MSE: 0.17264335821215582
MSE: 7.583341954386924e-07
MSE: 0.06631665280133348
MSE: 0.4225406888982528
108 PuertoRico
MSE: 1.7581829894197654e-06
MSE: 3.211040390258338e-07
MSE: 2.2689356340973604e-07
MSE: 1.4889521935401717e-06
109 Qatar
MSE: 1.4262332115322351e-07
MSE: 1.0822434133541845e-07
MSE: 9.578828589701526e-08
MSE: 5.445324191555301e-08
110 ROC
MSE: 1.6350531950592995e-07
MSE: 1.752787284203805e-07
MSE: 6.007121555740014e-08
MSE: 1.3271710486151278e-07
111 RefugeeOlympicTeam
MSE: 1.4199488305166597e-06
MSE: 0.0
MSE: 0.0
MSE: 1.4199488305166597e-06
112 Romania
MSE: 4.682085129465122
MSE: 0.0023860022158714855
MSE: 0.03766681315846654
MSE: 0.4349356939110862
113 Russia
MSE: 0.010707588458899409
MSE: 0.027287651206279406
MSE: 8.185452315956354e-08
MSE: 0.07871044465355226
114 SaintLucia
MSE: 1.5524549326073611e-06
MSE: 1.4199488305166597e-06
MSE: 1.4199488305166597e-06
MSE: 0.0
115 Samoa
MSE: 1.074163096010802e-08
MSE: 0.0
MSE: 1.074163096010802e-08
MSE: 0.0
116 SanMarino
MSE: 7.834591997379903e-08
MSE: 0.0
MSE: 4.778883209155538e-07
MSE: 1.0707914555041498e-07
117 SaudiArabia
MSE: 7.887379638304992e-09
MSE: 0.0
MSE: 2.623921915301253e-07
MSE: 4.986535256637552e-07
118 Senegal
MSE: 4.99626951493399e-10
MSE: 0.0
MSE: 4.99626951493399e-10
MSE: 0.0
119 Serbia
MSE: 1.477101250202395e-07
MSE: 2.1570394892478362e-07
MSE: 2.8090477144360193e-07
MSE: 1.4190391084412113e-07
120 SerbiaandMontenegro
MSE: 7.718895744801557e-09
MSE: 0.0
MSE: 7.718895744801557e-09
MSE: 0.0
121 Singapore
MSE: 1.1510792319313623e-10
MSE: 1.6884047836144305e-09
MSE: 1.398155706801059e-07
MSE: 5.7985971579910256e-08
122 Slovakia
MSE: 4.5220191680073185e-07
MSE: 1.1319621282318755e-06
MSE: 1.5416651523103239e-06
MSE: 2.8032619781015455e-08
123 Slovenia
MSE: 0.2425715807476081
MSE: 2.461115400365088e-08
MSE: 5.994852614321644e-09
MSE: 0.3530150804849974
124 SouthAfrica
MSE: 0.5164398081578838
MSE: 0.0506667008408499
MSE: 0.08793004583191077
MSE: 0.0007638633409356999
125 SouthKorea
MSE: 43.26979633342489
MSE: 8.856364980260878
MSE: 1.2459555987063595
MSE: 1.0008031549741645
126 Spain
MSE: 35.331490358920746
MSE: 0.10381211041021743
MSE: 0.17627111272395268
MSE: 2.291215537134349
127 SriLanka
MSE: 1.140026007704961e-08
MSE: 0.0
MSE: 1.140026007704961e-08
MSE: 0.0
128 Sudan
MSE: 1.074163096010802e-08
MSE: 0.0
MSE: 1.074163096010802e-08
MSE: 0.0
129 Suriname
MSE: 4.1797321159720013e-08
MSE: 1.654898907929553e-08
MSE: 0.0
MSE: 1.1631658389687339e-08
130 Sweden
MSE: 1.9083821927861209
MSE: 0.06598845990106383
MSE: 0.06784283701654203
MSE: 0.7962807892091064
131 Switzerland
MSE: 0.9667695876871676
MSE: 3.8678848104464123
MSE: 0.011723307024169571
MSE: 6.526305188073422
132 Syria
MSE: 3.324445074781579e-08
MSE: 1.6080186172781866e-08
MSE: 1.65282874911838e-08
MSE: 9.313225746154785e-08
133 Taiwan
MSE: 0.0
MSE: 0.0
MSE: 0.0
MSE: 0.0
134 Tajikistan
MSE: 1.6581680597482773e-06
MSE: 5.387291710150455e-09
MSE: 6.3767993767271316e-09
MSE: 1.377653063627804e-06
135 Tanzania
MSE: 1.6760225207690382e-08
MSE: 0.0
MSE: 1.6760225207690382e-08
MSE: 0.0
136 Thailand
MSE: 0.9632442612428349
MSE: 0.00017719934754723
MSE: 1.7095235307351686e-06
MSE: 0.21871474907038646
137 Togo
MSE: 1.074163096010802e-08
MSE: 0.0
MSE: 0.0
MSE: 1.074163096010802e-08
138 Tonga
MSE: 1.0778264337465494e-08
MSE: 0.0
MSE: 1.0778264337465494e-08
MSE: 0.0
139 TrinidadandTobago
MSE: 0.0032727213500862717
MSE: 1.8668228882745552e-06
MSE: 0.0019722895922882344
MSE: 0.00010224747132170364
140 Tunisia
MSE: 4.1224262758987607e-07
MSE: 4.604316927725449e-08
MSE: 3.049969166113442e-08
MSE: 1.6554061090801042e-06
141 Turkey
MSE: 4.860666316170864
MSE: 1.1744494875247256
MSE: 4.015513412259143
MSE: 4.807044206245337e-06
142 Turkmenistan
MSE: 4.778883209155538e-07
MSE: 0.0
MSE: 4.778883209155538e-07
MSE: 0.0
143 Uganda
MSE: 1.3815684951623552e-07
MSE: 5.908192690640135e-08
MSE: 4.330104275140911e-09
MSE: 4.754275237188478e-07
144 Ukraine
MSE: 3.40419490225122
MSE: 0.7299633708512943
MSE: 0.137955934971842
MSE: 0.03334851470049216
145 UnifiedTeam
MSE: 3.230670699849725e-07
MSE: 2.516353561077267e-07
MSE: 5.047922968515195e-07
MSE: 1.6350531950592995e-07
146 UnitedArabEmirates
MSE: 9.313225746154785e-08
MSE: 8.74015187083042e-09
MSE: 0.0
MSE: 2.1742369327171218e-07
147 UnitedStates
MSE: 5.0188551566097885
MSE: 14.137472632122808
MSE: 1.0510191714856774
MSE: 31.46059445689025
148 Uruguay
MSE: 1.2185466857772553e-08
MSE: 8.925877397551354e-09
MSE: 2.0251356147582555e-09
MSE: 1.2979553837339814e-09
149 Uzbekistan
MSE: 1.7145148376584984e-06
MSE: 0.45250979676438874
MSE: 0.9990391656192656
MSE: 1.9813847984551103e-07
150 Venezuela
MSE: 1.602439283487911e-07
MSE: 5.948828629698255e-08
MSE: 1.9244907889515162e-07
MSE: 3.937924236597676e-08
151 Vietnam
MSE: 2.516353561077267e-07
MSE: 3.211040390258338e-07
MSE: 1.0754776269550348e-07
MSE: 6.5833540192780865e-09
152 VirginIslands
MSE: 4.99626951493399e-10
MSE: 0.0
MSE: 4.99626951493399e-10
MSE: 0.0
153 Zambia
MSE: 3.324445074781579e-08
MSE: 0.0
MSE: 7.859672177473758e-10
MSE: 2.9385830657702172e-08
154 Zimbabwe
MSE: 7.781864042044617e-11
MSE: 5.2332339350869006e-08
MSE: 1.2535252835732535e-09
MSE: 1.140026007704961e-08
               NOC  Total\_Predicted  Total\_Lower  Total\_Upper  Gold\_Predicted  \textbackslash{}
0      Afghanistan                1            1            1               0
1          Albania                2            2            2               0
2          Algeria                5            4            6               2
3        Argentina                3            3            3               1
4          Armenia                4            4            4               0
..             {\ldots}              {\ldots}          {\ldots}          {\ldots}             {\ldots}
150      Venezuela                3            3            3               1
151        Vietnam                1            1            1               0
152  VirginIslands                0            0            0               0
153         Zambia                1            1            1               0
154       Zimbabwe                3            3            3               1

     Gold\_Lower  Gold\_Upper  Silver\_Predicted  Silver\_Lower  Silver\_Upper  \textbackslash{}
0             0           0                 0             0             0
1             0           0                 0             0             0
2             2           2                 0             0             0
3             1           1                 1             1             1
4             0           0                 3             3             3
..          {\ldots}         {\ldots}               {\ldots}           {\ldots}           {\ldots}
150           1           1                 2             2             2
151           0           0                 1             1             1
152           0           0                 0             0             0
153           0           0                 0             0             0
154           1           1                 2             2             2

     Bronze\_Predicted  Bronze\_Lower  Bronze\_Upper
0                   1             1             1
1                   2             2             2
2                   2             2             2
3                   1             1             1
4                   1             1             1
..                {\ldots}           {\ldots}           {\ldots}
150                 0             0             0
151                 0             0             0
152                 0             0             0
153                 1             1             1
154                 0             0             0

[155 rows x 13 columns]
    \end{Verbatim}

    \begin{itemize}
\tightlist
\item
  结论：XGBoost已经训练好的模型的值趋近于不变
\end{itemize}

    \subsection{贝叶斯方法}\label{ux8d1dux53f6ux65afux65b9ux6cd5}

    \subsubsection{先验预测}\label{ux5148ux9a8cux9884ux6d4b}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{norm}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{xgboost}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{XGBRegressor}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{,} \PY{n}{GridSearchCV}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{r2\PYZus{}score}\PY{p}{,} \PY{n}{mean\PYZus{}absolute\PYZus{}error}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LabelEncoder}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts\PYZus{}processed.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 将国家代码转换为数值标签}
\PY{n}{label\PYZus{}encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 处理缺失值}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建特征：前一届奥运会的奖牌总数、金牌数、银牌数、铜牌数}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 选择特征和目标变量}
\PY{n}{features} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{target\PYZus{}total} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}gold} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}silver} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{target\PYZus{}bronze} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 划分训练集和测试集}
\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}total}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}gold}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}silver}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{target\PYZus{}bronze}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义XGBoost模型}
\PY{n}{model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\PY{n}{model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 超参数优化}
\PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{150}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}
\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 使用GridSearchCV进行超参数优化}
\PY{n}{grid\PYZus{}search\PYZus{}total} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}total}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}gold}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}silver}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}bronze}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 训练模型}
\PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}total}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}gold}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}silver}\PY{p}{)}
\PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 获取最佳模型}
\PY{n}{best\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}total}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}gold}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}silver}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\PY{n}{best\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{grid\PYZus{}search\PYZus{}bronze}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}

\PY{c+c1}{\PYZsh{} 评估模型}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
    \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{mse} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n}{r2} \PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n}{mae} \PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE: }\PY{l+s+si}{\PYZob{}}\PY{n}{mse}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, R2: }\PY{l+s+si}{\PYZob{}}\PY{n}{r2}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{, MAE: }\PY{l+s+si}{\PYZob{}}\PY{n}{mae}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{n}{y\PYZus{}pred}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}total}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}total}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}total}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gold Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}gold}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}gold}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}gold}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Silver Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}silver}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}silver}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}silver}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bronze Medals Model Evaluation:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{evaluate\PYZus{}model}\PY{p}{(}\PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}bronze}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}bronze}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 贝叶斯更新}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean}\PY{p}{,} \PY{n}{prior\PYZus{}std}\PY{p}{,} \PY{n}{new\PYZus{}data}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{prior\PYZus{}mean}\PY{p}{)} \PY{o+ow}{or} \PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{prior\PYZus{}std}\PY{p}{)} \PY{o+ow}{or} \PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{new\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}
    
    \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{new\PYZus{}data}\PY{p}{)}
    \PY{n}{new\PYZus{}mean} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{new\PYZus{}data}\PY{p}{)}
    \PY{n}{new\PYZus{}std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{new\PYZus{}data}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} 避免除以零}
    \PY{k}{if} \PY{n}{prior\PYZus{}std} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{prior\PYZus{}std} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}6}
    \PY{k}{if} \PY{n}{new\PYZus{}std} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{new\PYZus{}std} \PY{o}{=} \PY{l+m+mf}{1e\PYZhy{}6}
    
    \PY{c+c1}{\PYZsh{} 更新后验分布的参数}
    \PY{n}{posterior\PYZus{}mean} \PY{o}{=} \PY{p}{(}\PY{n}{prior\PYZus{}mean} \PY{o}{/} \PY{n}{prior\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{new\PYZus{}mean} \PY{o}{*} \PY{n}{n} \PY{o}{/} \PY{n}{new\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{/} \PY{n}{prior\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{n} \PY{o}{/} \PY{n}{new\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{posterior\PYZus{}std} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{/} \PY{n}{prior\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{n}{n} \PY{o}{/} \PY{n}{new\PYZus{}std}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
    
    \PY{k}{return} \PY{n}{posterior\PYZus{}mean}\PY{p}{,} \PY{n}{posterior\PYZus{}std}

\PY{c+c1}{\PYZsh{} 使用历史数据作为先验分布}
\PY{n}{prior\PYZus{}mean\PYZus{}total} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}std\PYZus{}total} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}mean\PYZus{}gold} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}std\PYZus{}gold} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}mean\PYZus{}silver} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}std\PYZus{}silver} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}mean\PYZus{}bronze} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{prior\PYZus{}std\PYZus{}bronze} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 为每个国家单独训练模型}
\PY{n}{country\PYZus{}models} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 确保每个国家至少有两条记录}
        \PY{n}{country\PYZus{}features} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{country\PYZus{}target\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{n}{country\PYZus{}model\PYZus{}total} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}gold} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}silver} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}bronze} \PY{o}{=} \PY{n}{XGBRegressor}\PY{p}{(}\PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg:squarederror}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
        
        \PY{n}{country\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}total}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}gold}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}silver}\PY{p}{)}
        \PY{n}{country\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{country\PYZus{}features}\PY{p}{,} \PY{n}{country\PYZus{}target\PYZus{}bronze}\PY{p}{)}
        
        \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}total}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}gold}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}silver}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country\PYZus{}model\PYZus{}bronze}
        \PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 预测2028年奥运会的奖牌数}
\PY{n}{next\PYZus{}year} \PY{o}{=} \PY{l+m+mi}{2028}
\PY{n}{predictions} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{country} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{country}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{prev\PYZus{}total} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}gold} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}silver} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{prev\PYZus{}bronze} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{next\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{next\PYZus{}year}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}total}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}gold}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}silver}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Prev\PYZus{}Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{prev\PYZus{}bronze}\PY{p}{]}
        \PY{p}{\PYZcb{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用单独模型预测}
        \PY{n}{total\PYZus{}pred\PYZus{}private} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}private} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}private} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}private} \PY{o}{=} \PY{n}{country\PYZus{}models}\PY{p}{[}\PY{n}{country}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 使用整体模型预测}
        \PY{n}{total\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}total}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{gold\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{silver\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}silver}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        \PY{n}{bronze\PYZus{}pred\PYZus{}global} \PY{o}{=} \PY{n}{best\PYZus{}model\PYZus{}bronze}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{next\PYZus{}data}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 根据数据量分配权重}
        \PY{n}{data\PYZus{}count} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)}
        \PY{n}{weight} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{data\PYZus{}count} \PY{o}{/} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 数据量越多，权重越高，但不超过1}
        
        \PY{c+c1}{\PYZsh{} 贝叶斯更新}
        \PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}private}\PY{p}{,} \PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}total}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}total}\PY{p}{,} \PY{p}{[}\PY{n}{total\PYZus{}pred\PYZus{}private}\PY{p}{]}\PY{p}{)}
        \PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}private}\PY{p}{,} \PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}gold}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}gold}\PY{p}{,} \PY{p}{[}\PY{n}{gold\PYZus{}pred\PYZus{}private}\PY{p}{]}\PY{p}{)}
        \PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}private}\PY{p}{,} \PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}silver}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}silver}\PY{p}{,} \PY{p}{[}\PY{n}{silver\PYZus{}pred\PYZus{}private}\PY{p}{]}\PY{p}{)}
        \PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}private}\PY{p}{,} \PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}bronze}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}bronze}\PY{p}{,} \PY{p}{[}\PY{n}{bronze\PYZus{}pred\PYZus{}private}\PY{p}{]}\PY{p}{)}
        
        \PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}global}\PY{p}{,} \PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}global} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}total}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}total}\PY{p}{,} \PY{p}{[}\PY{n}{total\PYZus{}pred\PYZus{}global}\PY{p}{]}\PY{p}{)}
        \PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}global}\PY{p}{,} \PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}global} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}gold}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}gold}\PY{p}{,} \PY{p}{[}\PY{n}{gold\PYZus{}pred\PYZus{}global}\PY{p}{]}\PY{p}{)}
        \PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}global}\PY{p}{,} \PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}global} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}silver}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}silver}\PY{p}{,} \PY{p}{[}\PY{n}{silver\PYZus{}pred\PYZus{}global}\PY{p}{]}\PY{p}{)}
        \PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}global}\PY{p}{,} \PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}global} \PY{o}{=} \PY{n}{bayesian\PYZus{}update}\PY{p}{(}\PY{n}{prior\PYZus{}mean\PYZus{}bronze}\PY{p}{,} \PY{n}{prior\PYZus{}std\PYZus{}bronze}\PY{p}{,} \PY{p}{[}\PY{n}{bronze\PYZus{}pred\PYZus{}global}\PY{p}{]}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 合成预测结果}
        \PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}global}
        \PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}global}
        \PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}global}
        \PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}global}
        
        \PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}global}
        \PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}global}
        \PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}global}
        \PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}combined} \PY{o}{=} \PY{n}{weight} \PY{o}{*} \PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}private} \PY{o}{+} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{weight}\PY{p}{)} \PY{o}{*} \PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}global}
        
        \PY{c+c1}{\PYZsh{} 计算95\PYZpc{}置信区间}
        \PY{n}{total\PYZus{}lower}\PY{p}{,} \PY{n}{total\PYZus{}upper} \PY{o}{=} \PY{n}{norm}\PY{o}{.}\PY{n}{interval}\PY{p}{(}\PY{l+m+mf}{0.95}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{n}{total\PYZus{}posterior\PYZus{}std\PYZus{}combined}\PY{p}{)}
        \PY{n}{gold\PYZus{}lower}\PY{p}{,} \PY{n}{gold\PYZus{}upper} \PY{o}{=} \PY{n}{norm}\PY{o}{.}\PY{n}{interval}\PY{p}{(}\PY{l+m+mf}{0.95}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{n}{gold\PYZus{}posterior\PYZus{}std\PYZus{}combined}\PY{p}{)}
        \PY{n}{silver\PYZus{}lower}\PY{p}{,} \PY{n}{silver\PYZus{}upper} \PY{o}{=} \PY{n}{norm}\PY{o}{.}\PY{n}{interval}\PY{p}{(}\PY{l+m+mf}{0.95}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{n}{silver\PYZus{}posterior\PYZus{}std\PYZus{}combined}\PY{p}{)}
        \PY{n}{bronze\PYZus{}lower}\PY{p}{,} \PY{n}{bronze\PYZus{}upper} \PY{o}{=} \PY{n}{norm}\PY{o}{.}\PY{n}{interval}\PY{p}{(}\PY{l+m+mf}{0.95}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{n}{bronze\PYZus{}posterior\PYZus{}std\PYZus{}combined}\PY{p}{)}
        
        \PY{n}{predictions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{country}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}lower}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{total\PYZus{}upper}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}lower}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{gold\PYZus{}upper}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}lower}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{silver\PYZus{}upper}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}posterior\PYZus{}mean\PYZus{}combined}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}lower}\PY{p}{)}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{bronze\PYZus{}upper}\PY{p}{)}
        \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将预测结果转换为DataFrame}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{predictions}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将NOC标签转换回国家代码}
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{inverse\PYZus{}transform}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{predictions\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存预测结果到CSV文件}
\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}3.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Total Medals Model Evaluation:
MSE: 14.183948320207696, R2: 0.8897282113283617, MAE: 1.2766138611301299
Gold Medals Model Evaluation:
MSE: 2.9414593946059715, R2: 0.82618743758341, MAE: 0.553917856282124
Silver Medals Model Evaluation:
MSE: 1.8287626291987034, R2: 0.867498342532686, MAE: 0.5179618502816846
Bronze Medals Model Evaluation:
MSE: 2.185780634244944, R2: 0.8524910127837848, MAE: 0.5823690356586569
               NOC  Total\_Predicted  Total\_Lower  Total\_Upper  Gold\_Predicted  \textbackslash{}
0      Afghanistan                1            1            1               0
1          Albania                2            2            2               0
2          Algeria                5            5            5               2
3        Argentina                3            3            3               1
4          Armenia                4            4            4               0
..             {\ldots}              {\ldots}          {\ldots}          {\ldots}             {\ldots}
150      Venezuela                3            3            3               1
151        Vietnam                1            1            1               0
152  VirginIslands                0            0            0               0
153         Zambia                1            1            1               0
154       Zimbabwe                3            3            3               1

     Gold\_Lower  Gold\_Upper  Silver\_Predicted  Silver\_Lower  Silver\_Upper  \textbackslash{}
0             0           0                 0             0             0
1             0           0                 0             0             0
2             2           2                 0             0             0
3             1           1                 1             1             1
4             0           0                 3             3             3
..          {\ldots}         {\ldots}               {\ldots}           {\ldots}           {\ldots}
150           1           1                 2             2             2
151           0           0                 1             1             1
152           0           0                 0             0             0
153           0           0                 0             0             0
154           1           1                 2             2             2

     Bronze\_Predicted  Bronze\_Lower  Bronze\_Upper
0                   1             1             1
1                   2             2             2
2                   2             2             2
3                   1             1             1
4                   1             1             1
..                {\ldots}           {\ldots}           {\ldots}
150                 0             0             0
151                 0             0             0
152                 0             0             0
153                 1             1             1
154                 0             0             0

[155 rows x 13 columns]
    \end{Verbatim}

    \subsubsection{区间合成}\label{ux533aux95f4ux5408ux6210}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{file1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}3.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{file2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}olympics\PYZus{}medal\PYZus{}predictions\PYZus{}intervals.csv}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} 读取数据}
\PY{n}{df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file1}\PY{p}{)}
\PY{n}{df2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file2}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 合并两个数据框，基于NOC列}
\PY{n}{merged\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df1}\PY{p}{,} \PY{n}{df2}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{suffixes}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算均值、最大值和最小值}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{p}{(}\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{p}{(}\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{p}{(}\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{p}{(}\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper\PYZus{}file1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper\PYZus{}file2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 选择需要的列}
\PY{n}{final\PYZus{}df} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 保存结果到新的CSV文件}
\PY{n}{final\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{merged\PYZus{}olympics\PYZus{}medal\PYZus{}predictions.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n}{final\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           NOC  Total\_Predicted  Total\_Lower  Total\_Upper  Gold\_Predicted  \textbackslash{}
0  Afghanistan                1            1            1               0
1      Albania                2            2            2               0
2      Algeria                5            4            6               2
3    Argentina                3            3            3               1
4      Armenia                4            4            4               0

   Gold\_Lower  Gold\_Upper  Silver\_Predicted  Silver\_Lower  Silver\_Upper  \textbackslash{}
0           0           0                 0             0             0
1           0           0                 0             0             0
2           2           2                 0             0             0
3           1           1                 1             1             1
4           0           0                 3             3             3

   Bronze\_Predicted  Bronze\_Lower  Bronze\_Upper
0                 1             1             1
1                 2             2             2
2                 2             2             2
3                 1             1             1
4                 1             1             1
\end{Verbatim}
\end{tcolorbox}
        
    \section{结果分析}\label{ux7ed3ux679cux5206ux6790}

    \subsection{第一问}\label{ux7b2cux4e00ux95ee}

    • 构建一个模型，用于预测每个国家的奖牌数（至少包括金牌数和奖牌总数）。
请包含对模型预测的不确定度/精确度的估计以及模型性能的衡量指标。
根据您的模型，您对 2028 年美国洛杉矶夏季奥运会奖牌榜的预测结果是
什么？请给出所有结果的预测区间。您认为哪些国家最有可能取得进
步？哪些国家的表现会不如 2024 年？

    \subsubsection{国家相比2024年进步或退步}\label{ux56fdux5bb6ux76f8ux6bd42024ux5e74ux8fdbux6b65ux6216ux9000ux6b65}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取合并后的CSV文件}
\PY{n}{merged\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{merged\PYZus{}olympics\PYZus{}medal\PYZus{}predictions.csv}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} 读取数据}
\PY{n}{merged\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{merged\PYZus{}file}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 提取预测值列}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}

\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}Prediction\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 读取合并后的CSV文件}
\PY{n}{medal\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} 读取数据}
\PY{n}{medal\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{medal\PYZus{}file}\PY{p}{)}
\PY{n}{medal\PYZus{}df} \PY{o}{=} \PY{n}{medal\PYZus{}df}\PY{p}{[}\PY{n}{medal\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{2024}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 提取预测值列}
\PY{n}{predictions\PYZus{}df} \PY{o}{=} \PY{n}{medal\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{predictions\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}a\PYZhy{}zA\PYZhy{}Z]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{regex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}

\PY{n}{predictions\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2024\PYZus{}Observation\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 2024年奥运会奖牌榜}
\PY{n}{data\PYZus{}2024} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2024\PYZus{}Observation\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 2028年奥运会奖牌榜预测结果}
\PY{n}{data\PYZus{}2028} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}Prediction\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建DataFrame}
\PY{n}{df\PYZus{}2024} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data\PYZus{}2024}\PY{p}{)}
\PY{n}{df\PYZus{}2028} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data\PYZus{}2028}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 合并两个DataFrame}
\PY{n}{merged\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{df\PYZus{}2024}\PY{p}{,} \PY{n}{df\PYZus{}2028}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{outer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算奖牌总数和金牌数的变化}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Predicted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 判断进步或退步}
\PY{c+c1}{\PYZsh{}merged\PYZus{}df[\PYZsq{}Total\PYZus{}Progress\PYZsq{}] = merged\PYZus{}df.apply(lambda row: \PYZsq{}Front\PYZsq{} if row[\PYZsq{}Total\PYZus{}Change\PYZsq{}] / row[\PYZsq{}Total\PYZsq{}] \PYZgt{} 0.15 else \PYZsq{}Back\PYZsq{} if row[\PYZsq{}Total\PYZus{}Change\PYZsq{}] / row[\PYZsq{}Total\PYZsq{}] \PYZlt{} \PYZhy{}0.15 else \PYZsq{}Stable\PYZsq{}, axis=1)}
\PY{c+c1}{\PYZsh{}merged\PYZus{}df[\PYZsq{}Gold\PYZus{}Progress\PYZsq{}] = merged\PYZus{}df.apply(lambda row: \PYZsq{}Front\PYZsq{} if row[\PYZsq{}Gold\PYZus{}Change\PYZsq{}] / row[\PYZsq{}Gold\PYZsq{}] \PYZgt{} 0.15 else \PYZsq{}Back\PYZsq{} if row[\PYZsq{}Gold\PYZus{}Change\PYZsq{}] / row[\PYZsq{}Gold\PYZsq{}] \PYZlt{} \PYZhy{}0.15 else \PYZsq{}Stable\PYZsq{}, axis=1)}

\PY{c+c1}{\PYZsh{} 判断进步或退步(0检验)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Progress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Front}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.15} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Back}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Stable}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Front}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Stable}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NaN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Progress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{row}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Front}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.15} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Back}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Stable}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Front}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Stable}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}  \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NaN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 生成新的DataFrame}
\PY{n}{result\PYZus{}df} \PY{o}{=} \PY{n}{merged\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total\PYZus{}Progress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold\PYZus{}Progress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 重命名列}
\PY{n}{result\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{result\PYZus{}df}\PY{p}{)}

\PY{n}{result\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{2028\PYZus{}Olympics\PYZus{}country\PYZus{}progress.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
               NOC   Total    Gold
0      Afghanistan  Stable  Stable
1          Albania  Stable  Stable
2          Algeria   Front  Stable
3        Argentina  Stable  Stable
4          Armenia  Stable  Stable
..             {\ldots}     {\ldots}     {\ldots}
150      Venezuela  Stable  Stable
151        Vietnam  Stable  Stable
152  VirginIslands  Stable  Stable
153         Zambia  Stable  Stable
154       Zimbabwe  Stable  Stable

[155 rows x 3 columns]
    \end{Verbatim}

    \subsection{第二问}\label{ux7b2cux4e8cux95ee}

    \begin{itemize}
\tightlist
\item
  您的模型应涵盖尚未获得奖牌的国家；您预计在下一届奥运会中会有多少
  个国家获得其首枚奖牌？对于这个估计，您认为可能性有多大？
\end{itemize}

    \subsubsection{预处理}\label{ux9884ux5904ux7406}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{re}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 清洗国家名NOC，只保留英文字母}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{re}\PY{o}{.}\PY{n}{findall}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[A\PYZhy{}Za\PYZhy{}z]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 初始化字典来存储每个国家的第一枚奖牌时间和第一枚金牌时间}
\PY{n}{first\PYZus{}medal\PYZus{}time} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{n}{first\PYZus{}gold\PYZus{}time} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 遍历数据}
\PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{year} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{noc} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{gold} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{total} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} 如果国家尚未记录第一枚奖牌时间}
    \PY{k}{if} \PY{n}{noc} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{first\PYZus{}medal\PYZus{}time} \PY{o+ow}{and} \PY{n}{total} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{first\PYZus{}medal\PYZus{}time}\PY{p}{[}\PY{n}{noc}\PY{p}{]} \PY{o}{=} \PY{n}{year}
    
    \PY{c+c1}{\PYZsh{} 如果国家尚未记录第一枚金牌时间}
    \PY{k}{if} \PY{n}{noc} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{first\PYZus{}gold\PYZus{}time} \PY{o+ow}{and} \PY{n}{gold} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{first\PYZus{}gold\PYZus{}time}\PY{p}{[}\PY{n}{noc}\PY{p}{]} \PY{o}{=} \PY{n}{year}

\PY{c+c1}{\PYZsh{} 将结果转换为DataFrame}
\PY{n}{result} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n}{first\PYZus{}medal\PYZus{}time}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n}{first\PYZus{}medal\PYZus{}time}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{first\PYZus{}gold\PYZus{}time}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{noc}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)} \PY{k}{for} \PY{n}{noc} \PY{o+ow}{in} \PY{n}{first\PYZus{}medal\PYZus{}time}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存结果到CSV文件}
\PY{n}{result}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}times.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{结果已保存到 first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}times.csv 文件中。}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
结果已保存到 first\_medal\_and\_gold\_times.csv 文件中。
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}times.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义实际的奥运会年份}
\PY{n}{olympic\PYZus{}years} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1896}\PY{p}{,} \PY{l+m+mi}{1900}\PY{p}{,} \PY{l+m+mi}{1904}\PY{p}{,} \PY{l+m+mi}{1908}\PY{p}{,} \PY{l+m+mi}{1912}\PY{p}{,} \PY{l+m+mi}{1920}\PY{p}{,} \PY{l+m+mi}{1924}\PY{p}{,} \PY{l+m+mi}{1928}\PY{p}{,} \PY{l+m+mi}{1932}\PY{p}{,} \PY{l+m+mi}{1936}\PY{p}{,} \PY{l+m+mi}{1948}\PY{p}{,} \PY{l+m+mi}{1952}\PY{p}{,} \PY{l+m+mi}{1956}\PY{p}{,} \PY{l+m+mi}{1960}\PY{p}{,} \PY{l+m+mi}{1964}\PY{p}{,} \PY{l+m+mi}{1968}\PY{p}{,} \PY{l+m+mi}{1972}\PY{p}{,} \PY{l+m+mi}{1976}\PY{p}{,} \PY{l+m+mi}{1980}\PY{p}{,} \PY{l+m+mi}{1984}\PY{p}{,} \PY{l+m+mi}{1988}\PY{p}{,} \PY{l+m+mi}{1992}\PY{p}{,} \PY{l+m+mi}{1996}\PY{p}{,} \PY{l+m+mi}{2000}\PY{p}{,} \PY{l+m+mi}{2004}\PY{p}{,} \PY{l+m+mi}{2008}\PY{p}{,} \PY{l+m+mi}{2012}\PY{p}{,} \PY{l+m+mi}{2016}\PY{p}{,} \PY{l+m+mi}{2020}\PY{p}{,} \PY{l+m+mi}{2024}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 初始化字典来存储每届奥运会首次获得奖牌和金牌的国家数量}
\PY{n}{first\PYZus{}medal\PYZus{}counts} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{year}\PY{p}{:} \PY{l+m+mi}{0} \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{olympic\PYZus{}years}\PY{p}{\PYZcb{}}
\PY{n}{first\PYZus{}gold\PYZus{}counts} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{year}\PY{p}{:} \PY{l+m+mi}{0} \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{olympic\PYZus{}years}\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{} 遍历数据}
\PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{first\PYZus{}medal\PYZus{}time} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{n}{first\PYZus{}gold\PYZus{}time} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    
    \PY{k}{if} \PY{n}{first\PYZus{}medal\PYZus{}time} \PY{o+ow}{in} \PY{n}{first\PYZus{}medal\PYZus{}counts}\PY{p}{:}
        \PY{n}{first\PYZus{}medal\PYZus{}counts}\PY{p}{[}\PY{n}{first\PYZus{}medal\PYZus{}time}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    
    \PY{k}{if} \PY{n}{first\PYZus{}gold\PYZus{}time} \PY{o+ow}{in} \PY{n}{first\PYZus{}gold\PYZus{}counts} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{first\PYZus{}gold\PYZus{}time}\PY{p}{)}\PY{p}{:}
        \PY{n}{first\PYZus{}gold\PYZus{}counts}\PY{p}{[}\PY{n}{first\PYZus{}gold\PYZus{}time}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}

\PY{c+c1}{\PYZsh{} 将结果转换为DataFrame}
\PY{n}{result} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{olympic\PYZus{}years}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{first\PYZus{}medal\PYZus{}counts}\PY{p}{[}\PY{n}{year}\PY{p}{]} \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{olympic\PYZus{}years}\PY{p}{]}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{n}{first\PYZus{}gold\PYZus{}counts}\PY{p}{[}\PY{n}{year}\PY{p}{]} \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{olympic\PYZus{}years}\PY{p}{]}
\PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存结果到CSV文件}
\PY{n}{result}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}countries.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{结果已保存到 first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}countries.csv 文件中。}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
结果已保存到 first\_medal\_and\_gold\_countries.csv 文件中。
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}countries.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得奖牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得金牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加标题和标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries Winning Medals or Gold for the First Time in Each Olympic Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示网格}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图表}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_82_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{线性回归预测}\label{ux7ebfux6027ux56deux5f52ux9884ux6d4b}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}countries.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 准备数据}
\PY{n}{years} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{first\PYZus{}medal\PYZus{}countries} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\PY{n}{first\PYZus{}gold\PYZus{}countries} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}

\PY{c+c1}{\PYZsh{} 训练线性回归模型}
\PY{n}{model\PYZus{}medal} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}medal\PYZus{}countries}\PY{p}{)}

\PY{n}{model\PYZus{}gold} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}gold\PYZus{}countries}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 预测2028年的值}
\PY{n}{year\PYZus{}2028} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{pre\PYZus{}medal\PYZus{}2028} \PY{o}{=} \PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
\PY{n}{pre\PYZus{}gold\PYZus{}2028} \PY{o}{=} \PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得奖牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{,} \PY{n}{pre\PYZus{}medal\PYZus{}2028}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted First Medal Countries in 2028}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得金牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{,} \PY{n}{pre\PYZus{}gold\PYZus{}2028}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted First Gold Countries in 2028}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加标题和标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries Winning Medals or Gold for the First Time in Each Olympic Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示网格}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图表}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得奖牌的国家数量: }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}medal\PYZus{}2028}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得金牌的国家数量: }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}gold\PYZus{}2028}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_84_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
预测2028年首次获得奖牌的国家数量: 6
预测2028年首次获得金牌的国家数量: 5
    \end{Verbatim}

    \begin{itemize}
\tightlist
\item
  分析效果
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 计算模型的拟合度}
\PY{n}{r2\PYZus{}medal} \PY{o}{=} \PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}medal\PYZus{}countries}\PY{p}{)}
\PY{n}{r2\PYZus{}gold} \PY{o}{=} \PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}gold\PYZus{}countries}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得奖牌的国家数量模型的拟合度 (R\PYZca{}2): }\PY{l+s+si}{\PYZob{}}\PY{n}{r2\PYZus{}medal}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得金牌的国家数量模型的拟合度 (R\PYZca{}2): }\PY{l+s+si}{\PYZob{}}\PY{n}{r2\PYZus{}gold}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
首次获得奖牌的国家数量模型的拟合度 (R\^{}2): 0.02
首次获得金牌的国家数量模型的拟合度 (R\^{}2): 0.02
    \end{Verbatim}

    \begin{itemize}
\tightlist
\item
  这说明有2\%的可能完全准确
\item
  考虑到数目只为整数，可能性会更大
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{137}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 进行预测}
\PY{n}{pre\PYZus{}medal} \PY{o}{=} \PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{years}\PY{p}{)}
\PY{n}{pre\PYZus{}gold} \PY{o}{=} \PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{years}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 四舍五入预测值}
\PY{n}{pre\PYZus{}medal\PYZus{}rounded} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{pre\PYZus{}medal}\PY{p}{)}
\PY{n}{pre\PYZus{}gold\PYZus{}rounded} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{pre\PYZus{}gold}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算偏离}
\PY{n}{deviation\PYZus{}medal} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{pre\PYZus{}medal\PYZus{}rounded} \PY{o}{\PYZhy{}} \PY{n}{first\PYZus{}medal\PYZus{}countries}\PY{p}{)}
\PY{n}{deviation\PYZus{}gold} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{pre\PYZus{}gold\PYZus{}rounded} \PY{o}{\PYZhy{}} \PY{n}{first\PYZus{}gold\PYZus{}countries}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 统计偏离超过1的次数}
\PY{n}{count\PYZus{}deviation\PYZus{}medal\PYZus{}over\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{deviation\PYZus{}medal} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{count\PYZus{}deviation\PYZus{}gold\PYZus{}over\PYZus{}1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{deviation\PYZus{}gold} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算比例}
\PY{n}{proportion\PYZus{}deviation\PYZus{}medal\PYZus{}over\PYZus{}1} \PY{o}{=} \PY{n}{count\PYZus{}deviation\PYZus{}medal\PYZus{}over\PYZus{}1} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{years}\PY{p}{)}
\PY{n}{proportion\PYZus{}deviation\PYZus{}gold\PYZus{}over\PYZus{}1} \PY{o}{=} \PY{n}{count\PYZus{}deviation\PYZus{}gold\PYZus{}over\PYZus{}1} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{years}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出比例}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得奖牌的国家数量预测偏离超过1的比例: }\PY{l+s+si}{\PYZob{}}\PY{n}{proportion\PYZus{}deviation\PYZus{}medal\PYZus{}over\PYZus{}1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得金牌的国家数量预测偏离超过1的比例: }\PY{l+s+si}{\PYZob{}}\PY{n}{proportion\PYZus{}deviation\PYZus{}gold\PYZus{}over\PYZus{}1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得奖牌的国家数量预测准确度: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{proportion\PYZus{}deviation\PYZus{}medal\PYZus{}over\PYZus{}1}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{首次获得金牌的国家数量预测准确度: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{proportion\PYZus{}deviation\PYZus{}gold\PYZus{}over\PYZus{}1}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
首次获得奖牌的国家数量预测偏离超过1的比例: 0.57
首次获得金牌的国家数量预测偏离超过1的比例: 0.67
首次获得奖牌的国家数量预测准确度: 43.33\%
首次获得金牌的国家数量预测准确度: 33.33\%
    \end{Verbatim}

    \subsubsection{评估可能性}\label{ux8bc4ux4f30ux53efux80fdux6027}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{135}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{numpy}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{np}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{sm}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{plt}

\PY{c+c1}{\PYZsh{} 加载数据}
\PY{n}{file\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{first\PYZus{}medal\PYZus{}and\PYZus{}gold\PYZus{}countries.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{file\PYZus{}path}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 准备数据}
\PY{n}{years} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{first\PYZus{}medal\PYZus{}countries} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\PY{n}{first\PYZus{}gold\PYZus{}countries} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}

\PY{c+c1}{\PYZsh{} 训练线性回归模型}
\PY{n}{model\PYZus{}medal} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}medal\PYZus{}countries}\PY{p}{)}

\PY{n}{model\PYZus{}gold} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{years}\PY{p}{,} \PY{n}{first\PYZus{}gold\PYZus{}countries}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 预测2028年的值}
\PY{n}{year\PYZus{}2028} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{pre\PYZus{}medal\PYZus{}2028} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{model\PYZus{}medal}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\PY{n}{pre\PYZus{}gold\PYZus{}2028} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{model\PYZus{}gold}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 使用statsmodels计算置信区间}
\PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{years}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 添加常数项}
\PY{n}{model\PYZus{}medal\PYZus{}sm} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{first\PYZus{}medal\PYZus{}countries}\PY{p}{,} \PY{n}{X}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\PY{n}{model\PYZus{}gold\PYZus{}sm} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{first\PYZus{}gold\PYZus{}countries}\PY{p}{,} \PY{n}{X}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}medal\PYZus{}sm}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}gold\PYZus{}sm}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 预测2028年的值及其置信区间}
\PY{n}{year\PYZus{}2028\PYZus{}sm} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{year\PYZus{}2028}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 添加常数项}
\PY{n}{pre\PYZus{}medal\PYZus{}2028\PYZus{}sm} \PY{o}{=} \PY{n}{model\PYZus{}medal\PYZus{}sm}\PY{o}{.}\PY{n}{get\PYZus{}prediction}\PY{p}{(}\PY{n}{year\PYZus{}2028\PYZus{}sm}\PY{p}{)}\PY{o}{.}\PY{n}{summary\PYZus{}frame}\PY{p}{(}\PY{p}{)}
\PY{n}{pre\PYZus{}gold\PYZus{}2028\PYZus{}sm} \PY{o}{=} \PY{n}{model\PYZus{}gold\PYZus{}sm}\PY{o}{.}\PY{n}{get\PYZus{}prediction}\PY{p}{(}\PY{n}{year\PYZus{}2028\PYZus{}sm}\PY{p}{)}\PY{o}{.}\PY{n}{summary\PYZus{}frame}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制折线图}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得奖牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Medal Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{,} \PY{n}{pre\PYZus{}medal\PYZus{}2028}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted First Medal Countries in 2028}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 绘制第一次获得金牌的国家数}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First Gold Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{2028}\PY{p}{]}\PY{p}{,} \PY{n}{pre\PYZus{}gold\PYZus{}2028}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted First Gold Countries in 2028}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 添加置信区间}
\PY{c+c1}{\PYZsh{}plt.fill\PYZus{}between([2028], pre\PYZus{}medal\PYZus{}2028\PYZus{}sm[\PYZsq{}mean\PYZus{}ci\PYZus{}lower\PYZsq{}], pre\PYZus{}medal\PYZus{}2028\PYZus{}sm[\PYZsq{}mean\PYZus{}ci\PYZus{}upper\PYZsq{}], color=\PYZsq{}red\PYZsq{}, alpha=0.2)}
\PY{c+c1}{\PYZsh{}plt.fill\PYZus{}between([2028], pre\PYZus{}gold\PYZus{}2028\PYZus{}sm[\PYZsq{}mean\PYZus{}ci\PYZus{}lower\PYZsq{}], pre\PYZus{}gold\PYZus{}2028\PYZus{}sm[\PYZsq{}mean\PYZus{}ci\PYZus{}upper\PYZsq{}], color=\PYZsq{}green\PYZsq{}, alpha=0.2)}

\PY{c+c1}{\PYZsh{} 添加标题和标签}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries Winning Medals or Gold for the First Time in Each Olympic Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Countries}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示网格}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示图表}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出预测结果及其置信区间}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得奖牌的国家数量: }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}medal\PYZus{}2028}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得金牌的国家数量: }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}gold\PYZus{}2028}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得奖牌的国家数量的置信区间: [}\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}medal\PYZus{}2028\PYZus{}sm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}ci\PYZus{}lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}medal\PYZus{}2028\PYZus{}sm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}ci\PYZus{}upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{预测2028年首次获得金牌的国家数量的置信区间: [}\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}gold\PYZus{}2028\PYZus{}sm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}ci\PYZus{}lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}}\PY{n}{pre\PYZus{}gold\PYZus{}2028\PYZus{}sm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}ci\PYZus{}upper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.025
Model:                            OLS   Adj. R-squared:                 -0.010
Method:                 Least Squares   F-statistic:                    0.7110
Date:                Tue, 28 Jan 2025   Prob (F-statistic):              0.406
Time:                        02:34:37   Log-Likelihood:                -79.692
No. Observations:                  30   AIC:                             163.4
Df Residuals:                      28   BIC:                             166.2
Df Model:                           1
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const        -22.3475     32.992     -0.677      0.504     -89.928      45.233
x1             0.0142      0.017      0.843      0.406      -0.020       0.049
==============================================================================
Omnibus:                       12.296   Durbin-Watson:                   1.450
Prob(Omnibus):                  0.002   Jarque-Bera (JB):               11.745
Skew:                           1.241   Prob(JB):                      0.00282
Kurtosis:                       4.798   Cond. No.                     9.94e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly
specified.
[2] The condition number is large, 9.94e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
                            OLS Regression Results
==============================================================================
Dep. Variable:                      y   R-squared:                       0.015
Model:                            OLS   Adj. R-squared:                 -0.020
Method:                 Least Squares   F-statistic:                    0.4312
Date:                Tue, 28 Jan 2025   Prob (F-statistic):              0.517
Time:                        02:34:37   Log-Likelihood:                -78.874
No. Observations:                  30   AIC:                             161.7
Df Residuals:                      28   BIC:                             164.5
Df Model:                           1
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const        -17.1783     32.104     -0.535      0.597     -82.941      48.584
x1             0.0107      0.016      0.657      0.517      -0.023       0.044
==============================================================================
Omnibus:                       21.261   Durbin-Watson:                   1.473
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               29.640
Skew:                           1.775   Prob(JB):                     3.66e-07
Kurtosis:                       6.334   Cond. No.                     9.94e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly
specified.
[2] The condition number is large, 9.94e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{C_files/C_90_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
预测2028年首次获得奖牌的国家数量: 6
预测2028年首次获得金牌的国家数量: 5
预测2028年首次获得奖牌的国家数量的置信区间: [-182373.15, 91731.90]
预测2028年首次获得金牌的国家数量的置信区间: [-168204.18, 98528.84]
    \end{Verbatim}

    \subsection{第三问}\label{ux7b2cux4e09ux95ee}

    \begin{itemize}
\tightlist
\item
  您的模型还应考虑特定奥运会的赛事（数量和类型）。
\item
  探究赛事与各国所获奖牌数量之间的关系。
\item
  对于不同国家而言，哪些体育项目最为重要？原因何在？
\item
  主办国所选择的赛事如何影响比赛结果？
\end{itemize}

    \subsubsection{各国优势项目}\label{ux5404ux56fdux4f18ux52bfux9879ux76ee}

    \paragraph{预处理}\label{ux9884ux5904ux7406}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{142}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}athletes.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义一个函数，将Medal列中的值转换为对应的奖牌类型}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{medal\PYZus{}to\PYZus{}type}\PY{p}{(}\PY{n}{medal}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{medal} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{elif} \PY{n}{medal} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{elif} \PY{n}{medal} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No Medal}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} 应用函数转换Medal列}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medal\PYZus{}Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{medal\PYZus{}to\PYZus{}type}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 按NOC和Sport分组，统计每种奖牌的数量}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medal\PYZus{}Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No Medal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medal\PYZus{}Type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{n}{fill\PYZus{}value}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 重置索引，以便将NOC和Sport作为列}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失的奖牌类型列}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 确保奖牌列是数值类型}
\PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算总奖牌数}
\PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 重新排列列的顺序}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Silver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bronze}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 保存结果到CSV文件}
\PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated2}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 显示结果}
\PY{n}{medal\PYZus{}counts}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{142}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Medal\_Type  NOC                  Sport  Gold  Silver  Bronze  Total
0           AFG              Taekwondo     0       0       2      2
1           AHO                Sailing     0       1       0      1
2           AIN                 Rowing     0       1       0      1
3           AIN                 Tennis     0       2       0      2
4           AIN  Trampoline Gymnastics     1       1       0      2
\end{Verbatim}
\end{tcolorbox}
        
    \subsubsection{得出优势项目}\label{ux5f97ux51faux4f18ux52bfux9879ux76ee}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{162}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated2}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 定义一个函数，用于获取每个国家总奖牌榜和金牌榜前2的运动项目}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{get\PYZus{}top\PYZus{}sports}\PY{p}{(}\PY{n}{group}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{}print(group)}
    \PY{c+c1}{\PYZsh{} 按总奖牌数降序排列}
    \PY{n}{total\PYZus{}sorted} \PY{o}{=} \PY{n}{group}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
    \PY{c+c1}{\PYZsh{} 按金牌数降序排列}
    \PY{n}{gold\PYZus{}sorted} \PY{o}{=} \PY{n}{group}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} 获取前2的运动项目}
    \PY{n}{total\PYZus{}top2} \PY{o}{=} \PY{n}{total\PYZus{}sorted}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
    \PY{n}{gold\PYZus{}top2} \PY{o}{=} \PY{n}{gold\PYZus{}sorted}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
    
    \PY{c+c1}{\PYZsh{} 提取结果}
    \PY{n}{result} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{gold\PYZus{}top2}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{gold\PYZus{}top2}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{k+kc}{None}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{gold\PYZus{}top2}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{gold\PYZus{}top2}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{k}{else} \PY{k+kc}{None}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{total\PYZus{}top2}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{total\PYZus{}top2}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{k+kc}{None}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{total\PYZus{}top2}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{total\PYZus{}top2}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{k}{else} \PY{k+kc}{None}
    \PY{p}{\PYZcb{}}

    \PY{c+c1}{\PYZsh{}print(result)}
    
    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{result}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 应用函数，获取每个国家的前2运动项目}
\PY{n}{results} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{get\PYZus{}top\PYZus{}sports}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 保存到新的CSV文件}
\PY{n}{results}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated2}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{top\PYZus{}sports.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 打印结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{results}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
     NOC                  Gold1       Gold2      Total1                 Total2
0    AFG              Taekwondo        None   Taekwondo                   None
1    AHO                Sailing        None     Sailing                   None
2    AIN  Trampoline Gymnastics      Rowing      Tennis  Trampoline Gymnastics
3    ALB              Wrestling        None   Wrestling                   None
4    ALG              Athletics      Boxing   Athletics                 Boxing
..   {\ldots}                    {\ldots}         {\ldots}         {\ldots}                    {\ldots}
152  VIE               Shooting   Taekwondo    Shooting              Taekwondo
153  WIF              Athletics        None   Athletics                   None
154  YUG               Handball  Water Polo  Basketball             Water Polo
155  ZAM              Athletics      Boxing   Athletics                 Boxing
156  ZIM                 Hockey    Swimming      Hockey               Swimming

[157 rows x 5 columns]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}Ziqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_20880\textbackslash{}3729593612.py:31:
DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns.
This behavior is deprecated, and in a future version of pandas the grouping
columns will be excluded from the operation. Either pass `include\_groups=False`
to exclude the groupings or explicitly select the grouping columns after groupby
to silence this warning.
  results = df.groupby('NOC').apply(get\_top\_sports).reset\_index()
    \end{Verbatim}

    \subsection{东道主效应}\label{ux4e1cux9053ux4e3bux6548ux5e94}

    \begin{itemize}
\tightlist
\item
  回归分析模型
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{244}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 导入必要的库}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{pandas}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{pd}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api}\PY{+w}{ }\PY{k}{as}\PY{+w}{ }\PY{n+nn}{sm}
\PY{k+kn}{import}\PY{+w}{ }\PY{n+nn}{re}
\PY{k+kn}{from}\PY{+w}{ }\PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{+w}{ }\PY{k+kn}{import} \PY{n}{StandardScaler}

\PY{c+c1}{\PYZsh{} 读取CSV文件}
\PY{n}{medal\PYZus{}counts} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}medal\PYZus{}counts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{hosts} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2025\PYZus{}Problem\PYZus{}C\PYZus{}Data}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{summerOly\PYZus{}hosts.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{project\PYZus{}amount} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Generated}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{Project\PYZus{}amount.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 数据预处理}
\PY{c+c1}{\PYZsh{} 去除NOC列和Host列中的非英文字符}
\PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}a\PYZhy{}zA\PYZhy{}Z]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)}
\PY{n}{hosts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{hosts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}a\PYZhy{}zA\PYZhy{}Z]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 如果Host中的字符串包含NOC中的字符串，就将其替换为NOC的值}
\PY{k}{def}\PY{+w}{ }\PY{n+nf}{replace\PYZus{}host}\PY{p}{(}\PY{n}{row}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{noc} \PY{o+ow}{in} \PY{n}{medal\PYZus{}counts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
        \PY{k}{if} \PY{n}{noc} \PY{o+ow}{in} \PY{n}{row}\PY{p}{:}
            \PY{k}{return} \PY{n}{noc}
    \PY{k}{return} \PY{n}{row}

\PY{n}{hosts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{hosts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{replace\PYZus{}host}\PY{p}{)}
\PY{n}{hosts}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{hosts}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LondonUnitedKingdom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GreatBritain}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{} 将medal\PYZus{}counts和hosts数据按Year列合并}
\PY{n}{merged\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{medal\PYZus{}counts}\PY{p}{,} \PY{n}{hosts}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将merged\PYZus{}data和project\PYZus{}amount数据按Year列合并}
\PY{n}{merged\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{,} \PY{n}{project\PYZus{}amount}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 填充缺失值}
\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 创建东道主标识变量}
\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 选择特征和目标变量}
\PY{n}{X} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{y} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} 数据标准化}
\PY{c+c1}{\PYZsh{}scaler = StandardScaler()}
\PY{c+c1}{\PYZsh{}X\PYZus{}scaled = scaler.fit\PYZus{}transform(X)}

\PY{c+c1}{\PYZsh{} 添加常数项}
\PY{c+c1}{\PYZsh{}X\PYZus{}scaled = sm.add\PYZus{}constant(X\PYZus{}scaled)}
\PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 构建回归模型}
\PY{n}{model} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出模型结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 对每个国家分别进行回归分析}
\PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{noc} \PY{o+ow}{in} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{country\PYZus{}data} \PY{o}{=} \PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{n}{merged\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{noc}\PY{p}{]}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{country\PYZus{}data}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}  \PY{c+c1}{\PYZsh{} 确保每个国家至少有两条数据}
        \PY{n}{X\PYZus{}country} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amount}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        \PY{n}{y\PYZus{}country} \PY{o}{=} \PY{n}{country\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} 数据标准化}
        \PY{c+c1}{\PYZsh{}X\PYZus{}country\PYZus{}scaled = scaler.fit\PYZus{}transform(X\PYZus{}country)}
        
        \PY{c+c1}{\PYZsh{} 添加常数项}
        \PY{c+c1}{\PYZsh{}X\PYZus{}country\PYZus{}scaled = sm.add\PYZus{}constant(X\PYZus{}country\PYZus{}scaled)}
        \PY{n}{X\PYZus{}country} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{X\PYZus{}country}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} 构建回归模型}
        \PY{n}{model\PYZus{}country} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{y\PYZus{}country}\PY{p}{,} \PY{n}{X\PYZus{}country}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 保存结果}
        \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{noc}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host\PYZus{}Coef}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{model\PYZus{}country}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host\PYZus{}PValue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{model\PYZus{}country}\PY{o}{.}\PY{n}{pvalues}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{p}{\PYZcb{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 将结果转换为DataFrame}
\PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 输出每个国家的东道主效应结果}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{results\PYZus{}df}\PY{p}{)}

\PY{c+c1}{\PYZsh{} 计算并输出Is\PYZus{}Host系数的均值}
\PY{n}{is\PYZus{}host\PYZus{}mean} \PY{o}{=} \PY{n}{results\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Is\PYZus{}Host\PYZus{}Coef}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Is\PYZus{}Host系数的均值: }\PY{l+s+si}{\PYZob{}}\PY{n}{is\PYZus{}host\PYZus{}mean}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
                            OLS Regression Results
==============================================================================
Dep. Variable:                  Total   R-squared:                       0.942
Model:                            OLS   Adj. R-squared:                  0.942
Method:                 Least Squares   F-statistic:                     7701.
Date:                  周二, 28 1月 2025   Prob (F-statistic):               0.00
Time:                        06:12:02   Log-Likelihood:                -4405.0
No. Observations:                1435   AIC:                             8818.
Df Residuals:                    1431   BIC:                             8839.
Df Model:                           3
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          2.0739      0.447      4.636      0.000       1.196       2.951
Gold           2.4847      0.018    140.611      0.000       2.450       2.519
Is\_Host        1.9067      1.055      1.807      0.071      -0.163       3.977
Amount         0.0005      0.001      0.689      0.491      -0.001       0.002
==============================================================================
Omnibus:                      448.481   Durbin-Watson:                   1.979
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             5078.169
Skew:                           1.119   Prob(JB):                         0.00
Kurtosis:                      11.940   Cond. No.                     4.23e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly
specified.
[2] The condition number is large, 4.23e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
              NOC  Is\_Host\_Coef  Is\_Host\_PValue
0    UnitedStates      5.446768        0.652329
1          Greece      5.424184        0.311642
2         Germany     16.535894        0.213560
3          France     14.879555        0.030750
4    GreatBritain      1.250883        0.837392
..            {\ldots}           {\ldots}             {\ldots}
122        Cyprus      0.000000             NaN
123     Guatemala      0.000000             NaN
124          Fiji      0.000000             NaN
125        Jordan      0.000000             NaN
126        Kosovo      0.000000             NaN

[127 rows x 3 columns]
Is\_Host系数的均值: 1.01
    \end{Verbatim}

    \begin{itemize}
\tightlist
\item
  Is\_Host系数均值明显为正，说明成为东道主对总奖牌数有正面促进作用。
\end{itemize}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
